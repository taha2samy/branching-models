<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>

<style type='text/css'>html {overflow-x: initial !important;}:root { --bg-color: #ffffff; --text-color: #333333; --select-text-bg-color: #B5D6FC; --select-text-font-color: auto; --monospace: "Lucida Console",Consolas,"Courier",monospace; --title-bar-height: 20px; }
.mac-os-11 { --title-bar-height: 28px; }
html { font-size: 14px; background-color: var(--bg-color); color: var(--text-color); font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased; }
h1, h2, h3, h4, h5 { white-space: pre-wrap; }
body { margin: 0px; padding: 0px; height: auto; inset: 0px; font-size: 1rem; line-height: 1.42857; overflow-x: hidden; background: inherit; }
iframe { margin: auto; }
a.url { word-break: break-all; }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { text-shadow: none; background: var(--select-text-bg-color); color: var(--select-text-font-color); }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; overflow-wrap: break-word; position: relative; white-space: normal; overflow-x: visible; padding-top: 36px; }
#write.first-line-indent p { text-indent: 2em; }
#write.first-line-indent li p, #write.first-line-indent p * { text-indent: 0px; }
#write.first-line-indent li { margin-left: 2em; }
.for-image #write { padding-left: 8px; padding-right: 8px; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
.typora-export .footnote-line, .typora-export li, .typora-export p { white-space: pre-wrap; }
.typora-export .task-list-item input { pointer-events: none; }
@media screen and (max-width: 500px) {
  body.typora-export { padding-left: 0px; padding-right: 0px; }
  #write { padding-left: 20px; padding-right: 20px; }
}
#write li > figure:last-child { margin-bottom: 0.5rem; }
#write ol, #write ul { position: relative; }
img { max-width: 100%; vertical-align: middle; image-orientation: from-image; }
button, input, select, textarea { color: inherit; font: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
*, ::after, ::before { box-sizing: border-box; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p, #write pre { width: inherit; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p { position: relative; }
p { line-height: inherit; }
h1, h2, h3, h4, h5, h6 { break-after: avoid-page; break-inside: avoid; orphans: 4; }
p { orphans: 4; }
h1 { font-size: 2rem; }
h2 { font-size: 1.8rem; }
h3 { font-size: 1.6rem; }
h4 { font-size: 1.4rem; }
h5 { font-size: 1.2rem; }
h6 { font-size: 1rem; }
.md-math-block, .md-rawblock, h1, h2, h3, h4, h5, h6, p { margin-top: 1rem; margin-bottom: 1rem; }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: 700; font-style: italic; }
a { cursor: pointer; }
sup.md-footnote { padding: 2px 4px; background-color: rgba(238, 238, 238, 0.7); color: rgb(85, 85, 85); border-radius: 4px; cursor: pointer; }
sup.md-footnote a, sup.md-footnote a:hover { color: inherit; text-transform: inherit; text-decoration: inherit; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; }
figure { overflow-x: auto; margin: 1.2em 0px; max-width: calc(100% + 16px); padding: 0px; }
figure > table { margin: 0px; }
thead, tr { break-inside: avoid; break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; break-inside: auto; text-align: left; }
table.md-table td { min-width: 32px; }
.CodeMirror-gutters { border-right: 0px; background-color: inherit; }
.CodeMirror-linenumber { user-select: none; }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
#write pre { white-space: pre-wrap; }
#write.fences-no-line-wrapping pre { white-space: pre; }
#write pre.ty-contain-cm { white-space: normal; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences { font-size: 0.9rem; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: pre; background: inherit; position: relative !important; }
.md-fences-adv-panel { width: 100%; margin-top: 10px; text-align: center; padding-top: 0px; padding-bottom: 8px; overflow-x: auto; }
#write .md-fences.mock-cm { white-space: pre-wrap; }
.md-fences.md-fences-with-lineno { padding-left: 0px; }
#write.fences-no-line-wrapping .md-fences.mock-cm { white-space: pre; overflow-x: auto; }
.md-fences.mock-cm.md-fences-with-lineno { padding-left: 8px; }
.CodeMirror-line, twitterwidget { break-inside: avoid; }
svg { break-inside: avoid; }
.footnotes { opacity: 0.8; font-size: 0.9rem; margin-top: 1em; margin-bottom: 1em; }
.footnotes + .footnotes { margin-top: 0px; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; background: 0px 0px; text-decoration: none; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; -webkit-tap-highlight-color: transparent; line-height: normal; font-weight: 400; text-align: left; box-sizing: content-box; direction: ltr; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li .mathjax-block, li p { margin: 0.5rem 0px; }
li blockquote { margin: 1rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child, li > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; white-space: normal; }
#write .footnote-line { white-space: pre-wrap; }
@media print {
  body, html { border: 1px solid transparent; height: 99%; break-after: avoid; break-before: avoid; font-variant-ligatures: no-common-ligatures; }
  #write { margin-top: 0px; border-color: transparent !important; padding-top: 0px !important; padding-bottom: 0px !important; }
  .typora-export * { -webkit-print-color-adjust: exact; }
  .typora-export #write { break-after: avoid; }
  .typora-export #write::after { height: 0px; }
  .is-mac table { break-inside: avoid; }
  #write > p:nth-child(1) { margin-top: 0px; }
  .typora-export-show-outline .typora-export-sidebar { display: none; }
  figure { overflow-x: visible; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
pre.md-meta-block { font-size: 0.8rem; min-height: 0.8rem; white-space: pre-wrap; background: rgb(204, 204, 204); display: block; overflow-x: hidden; }
p > .md-image:only-child:not(.md-img-error) img, p > img:only-child { display: block; margin: auto; }
#write.first-line-indent p > .md-image:only-child:not(.md-img-error) img { left: -2em; position: relative; }
p > .md-image:only-child { display: inline-block; width: 100%; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.md-math-block { width: 100%; }
.md-math-block:not(:empty)::after { display: none; }
.MathJax_ref { fill: currentcolor; }
[contenteditable="true"]:active, [contenteditable="true"]:focus, [contenteditable="false"]:active, [contenteditable="false"]:focus { outline: 0px; box-shadow: none; }
.md-task-list-item { position: relative; list-style-type: none; }
.task-list-item.md-task-list-item { padding-left: 0px; }
.md-task-list-item > input { position: absolute; top: 0px; left: 0px; margin-left: -1.2em; margin-top: calc(1em - 10px); border: none; }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc-content::after, .md-toc::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); }
.md-toc-item a { text-decoration: none; }
.md-toc-inner:hover { text-decoration: underline; }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: 700; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; }
@media screen and (max-width: 48em) {
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h6 .md-toc-inner { margin-left: 8em; }
}
a.md-toc-inner { font-size: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.reversefootnote { font-family: ui-monospace, sans-serif; }
.md-attr { display: none; }
.md-fn-count::after { content: "."; }
code, pre, samp, tt { font-family: var(--monospace); }
kbd { margin: 0px 0.1em; padding: 0.1em 0.6em; font-size: 0.8em; color: rgb(36, 39, 41); background: rgb(255, 255, 255); border: 1px solid rgb(173, 179, 185); border-radius: 3px; box-shadow: rgba(12, 13, 14, 0.2) 0px 1px 0px, rgb(255, 255, 255) 0px 0px 0px 2px inset; white-space: nowrap; vertical-align: middle; }
.md-comment { color: rgb(162, 127, 3); opacity: 0.6; font-family: var(--monospace); }
code { text-align: left; vertical-align: initial; }
a.md-print-anchor { white-space: pre !important; border-width: initial !important; border-style: none !important; border-color: initial !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: 0px !important; background: 0px 0px !important; text-decoration: initial !important; text-shadow: initial !important; }
.os-windows.monocolor-emoji .md-emoji { font-family: "Segoe UI Symbol", sans-serif; }
.md-diagram-panel > svg { max-width: 100%; }
[lang="flow"] svg, [lang="mermaid"] svg { max-width: 100%; height: auto; }
[lang="mermaid"] .node text { font-size: 1rem; }
table tr th { border-bottom: 0px; }
video { max-width: 100%; display: block; margin: 0px auto; }
iframe { max-width: 100%; width: 100%; border: none; }
.highlight td, .highlight tr { border: 0px; }
mark { background: rgb(255, 255, 0); color: rgb(0, 0, 0); }
.md-html-inline .md-plain, .md-html-inline strong, mark .md-inline-math, mark strong { color: inherit; }
.md-expand mark .md-meta { opacity: 0.3 !important; }
mark .md-meta { color: rgb(0, 0, 0); }
@media print {
  .typora-export h1, .typora-export h2, .typora-export h3, .typora-export h4, .typora-export h5, .typora-export h6 { break-inside: avoid; }
}
.md-diagram-panel .messageText { stroke: none !important; }
.md-diagram-panel .start-state { fill: var(--node-fill); }
.md-diagram-panel .edgeLabel rect { opacity: 1 !important; }
.md-fences.md-fences-math { font-size: 1em; }
.md-fences-advanced:not(.md-focus) { padding: 0px; white-space: nowrap; border: 0px; }
.md-fences-advanced:not(.md-focus) { background: inherit; }
.typora-export-show-outline .typora-export-content { max-width: 1440px; margin: auto; display: flex; flex-direction: row; }
.typora-export-sidebar { width: 300px; font-size: 0.8rem; margin-top: 80px; margin-right: 18px; }
.typora-export-show-outline #write { --webkit-flex: 2; flex: 2 1 0%; }
.typora-export-sidebar .outline-content { position: fixed; top: 0px; max-height: 100%; overflow: hidden auto; padding-bottom: 30px; padding-top: 60px; width: 300px; }
@media screen and (max-width: 1024px) {
  .typora-export-sidebar, .typora-export-sidebar .outline-content { width: 240px; }
}
@media screen and (max-width: 800px) {
  .typora-export-sidebar { display: none; }
}
.outline-content li, .outline-content ul { margin-left: 0px; margin-right: 0px; padding-left: 0px; padding-right: 0px; list-style: none; overflow-wrap: anywhere; }
.outline-content ul { margin-top: 0px; margin-bottom: 0px; }
.outline-content strong { font-weight: 400; }
.outline-expander { width: 1rem; height: 1.42857rem; position: relative; display: table-cell; vertical-align: middle; cursor: pointer; padding-left: 4px; }
.outline-expander::before { content: ""; position: relative; font-family: Ionicons; display: inline-block; font-size: 8px; vertical-align: middle; }
.outline-item { padding-top: 3px; padding-bottom: 3px; cursor: pointer; }
.outline-expander:hover::before { content: ""; }
.outline-h1 > .outline-item { padding-left: 0px; }
.outline-h2 > .outline-item { padding-left: 1em; }
.outline-h3 > .outline-item { padding-left: 2em; }
.outline-h4 > .outline-item { padding-left: 3em; }
.outline-h5 > .outline-item { padding-left: 4em; }
.outline-h6 > .outline-item { padding-left: 5em; }
.outline-label { cursor: pointer; display: table-cell; vertical-align: middle; text-decoration: none; color: inherit; }
.outline-label:hover { text-decoration: underline; }
.outline-item:hover { border-color: rgb(245, 245, 245); background-color: var(--item-hover-bg-color); }
.outline-item:hover { margin-left: -28px; margin-right: -28px; border-left: 28px solid transparent; border-right: 28px solid transparent; }
.outline-item-single .outline-expander::before, .outline-item-single .outline-expander:hover::before { display: none; }
.outline-item-open > .outline-item > .outline-expander::before { content: ""; }
.outline-children { display: none; }
.info-panel-tab-wrapper { display: none; }
.outline-item-open > .outline-children { display: block; }
.typora-export .outline-item { padding-top: 1px; padding-bottom: 1px; }
.typora-export .outline-item:hover { margin-right: -8px; border-right: 8px solid transparent; }
.typora-export .outline-expander::before { content: "+"; font-family: inherit; top: -1px; }
.typora-export .outline-expander:hover::before, .typora-export .outline-item-open > .outline-item > .outline-expander::before { content: "−"; }
.typora-export-collapse-outline .outline-children { display: none; }
.typora-export-collapse-outline .outline-item-open > .outline-children, .typora-export-no-collapse-outline .outline-children { display: block; }
.typora-export-no-collapse-outline .outline-expander::before { content: "" !important; }
.typora-export-show-outline .outline-item-active > .outline-item .outline-label { font-weight: 700; }
.md-inline-math-container mjx-container { zoom: 0.95; }
mjx-container { break-inside: avoid; }
.md-alert.md-alert-note { border-left-color: rgb(9, 105, 218); }
.md-alert.md-alert-important { border-left-color: rgb(130, 80, 223); }
.md-alert.md-alert-warning { border-left-color: rgb(154, 103, 0); }
.md-alert.md-alert-tip { border-left-color: rgb(31, 136, 61); }
.md-alert.md-alert-caution { border-left-color: rgb(207, 34, 46); }
.md-alert { padding: 0px 1em; margin-bottom: 16px; color: inherit; border-left: 0.25em solid rgb(0, 0, 0); }
.md-alert-text-note { color: rgb(9, 105, 218); }
.md-alert-text-important { color: rgb(130, 80, 223); }
.md-alert-text-warning { color: rgb(154, 103, 0); }
.md-alert-text-tip { color: rgb(31, 136, 61); }
.md-alert-text-caution { color: rgb(207, 34, 46); }
.md-alert-text { font-size: 0.9rem; font-weight: 700; }
.md-alert-text svg { fill: currentcolor; position: relative; top: 0.125em; margin-right: 1ch; overflow: visible; }
.md-alert-text-container::after { content: attr(data-text); text-transform: capitalize; pointer-events: none; margin-right: 1ch; }


.CodeMirror { height: auto; }
.CodeMirror.cm-s-inner { background: inherit; }
.CodeMirror-scroll { overflow: auto hidden; z-index: 3; }
.CodeMirror-gutter-filler, .CodeMirror-scrollbar-filler { background-color: rgb(255, 255, 255); }
.CodeMirror-gutters { border-right: 1px solid rgb(221, 221, 221); background: inherit; white-space: nowrap; }
.CodeMirror-linenumber { padding: 0px 3px 0px 5px; text-align: right; color: rgb(153, 153, 153); }
.cm-s-inner .cm-keyword { color: rgb(119, 0, 136); }
.cm-s-inner .cm-atom, .cm-s-inner.cm-atom { color: rgb(34, 17, 153); }
.cm-s-inner .cm-number { color: rgb(17, 102, 68); }
.cm-s-inner .cm-def { color: rgb(0, 0, 255); }
.cm-s-inner .cm-variable { color: rgb(0, 0, 0); }
.cm-s-inner .cm-variable-2 { color: rgb(0, 85, 170); }
.cm-s-inner .cm-variable-3 { color: rgb(0, 136, 85); }
.cm-s-inner .cm-string { color: rgb(170, 17, 17); }
.cm-s-inner .cm-property { color: rgb(0, 0, 0); }
.cm-s-inner .cm-operator { color: rgb(152, 26, 26); }
.cm-s-inner .cm-comment, .cm-s-inner.cm-comment { color: rgb(170, 85, 0); }
.cm-s-inner .cm-string-2 { color: rgb(255, 85, 0); }
.cm-s-inner .cm-meta { color: rgb(85, 85, 85); }
.cm-s-inner .cm-qualifier { color: rgb(85, 85, 85); }
.cm-s-inner .cm-builtin { color: rgb(51, 0, 170); }
.cm-s-inner .cm-bracket { color: rgb(153, 153, 119); }
.cm-s-inner .cm-tag { color: rgb(17, 119, 0); }
.cm-s-inner .cm-attribute { color: rgb(0, 0, 204); }
.cm-s-inner .cm-header, .cm-s-inner.cm-header { color: rgb(0, 0, 255); }
.cm-s-inner .cm-quote, .cm-s-inner.cm-quote { color: rgb(0, 153, 0); }
.cm-s-inner .cm-hr, .cm-s-inner.cm-hr { color: rgb(153, 153, 153); }
.cm-s-inner .cm-link, .cm-s-inner.cm-link { color: rgb(0, 0, 204); }
.cm-negative { color: rgb(221, 68, 68); }
.cm-positive { color: rgb(34, 153, 34); }
.cm-header, .cm-strong { font-weight: 700; }
.cm-del { text-decoration: line-through; }
.cm-em { font-style: italic; }
.cm-link { text-decoration: underline; }
.cm-error { color: red; }
.cm-invalidchar { color: red; }
.cm-constant { color: rgb(38, 139, 210); }
.cm-defined { color: rgb(181, 137, 0); }
div.CodeMirror span.CodeMirror-matchingbracket { color: rgb(0, 255, 0); }
div.CodeMirror span.CodeMirror-nonmatchingbracket { color: rgb(255, 34, 34); }
.cm-s-inner .CodeMirror-activeline-background { background: inherit; }
.CodeMirror { position: relative; overflow: hidden; }
.CodeMirror-scroll { height: 100%; outline: 0px; position: relative; box-sizing: content-box; background: inherit; }
.CodeMirror-sizer { position: relative; }
.CodeMirror-gutter-filler, .CodeMirror-hscrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-vscrollbar { position: absolute; z-index: 6; display: none; outline: 0px; }
.CodeMirror-vscrollbar { right: 0px; top: 0px; overflow: hidden; }
.CodeMirror-hscrollbar { bottom: 0px; left: 0px; overflow: auto hidden; }
.CodeMirror-scrollbar-filler { right: 0px; bottom: 0px; }
.CodeMirror-gutter-filler { left: 0px; bottom: 0px; }
.CodeMirror-gutters { position: absolute; left: 0px; top: 0px; padding-bottom: 10px; z-index: 3; overflow-y: hidden; }
.CodeMirror-gutter { white-space: normal; height: 100%; box-sizing: content-box; padding-bottom: 30px; margin-bottom: -32px; display: inline-block; }
.CodeMirror-gutter-wrapper { position: absolute; z-index: 4; background: 0px 0px !important; border: none !important; }
.CodeMirror-gutter-background { position: absolute; top: 0px; bottom: 0px; z-index: 4; }
.CodeMirror-gutter-elt { position: absolute; cursor: default; z-index: 4; }
.CodeMirror-lines { cursor: text; }
.CodeMirror pre { border-radius: 0px; border-width: 0px; background: 0px 0px; font-family: inherit; font-size: inherit; margin: 0px; white-space: pre; overflow-wrap: normal; color: inherit; z-index: 2; position: relative; overflow: visible; }
.CodeMirror-wrap pre { overflow-wrap: break-word; white-space: pre-wrap; word-break: normal; }
.CodeMirror-code pre { border-right: 30px solid transparent; width: fit-content; }
.CodeMirror-wrap .CodeMirror-code pre { border-right: none; width: auto; }
.CodeMirror-linebackground { position: absolute; inset: 0px; z-index: 0; }
.CodeMirror-linewidget { position: relative; z-index: 2; overflow: auto; }
.CodeMirror-wrap .CodeMirror-scroll { overflow-x: hidden; }
.CodeMirror-measure { position: absolute; width: 100%; height: 0px; overflow: hidden; visibility: hidden; }
.CodeMirror-measure pre { position: static; }
.CodeMirror div.CodeMirror-cursor { position: absolute; visibility: hidden; border-right: none; width: 0px; }
.CodeMirror div.CodeMirror-cursor { visibility: hidden; }
.CodeMirror-focused div.CodeMirror-cursor { visibility: inherit; }
.cm-searching { background: rgba(255, 255, 0, 0.4); }
span.cm-underlined { text-decoration: underline; }
span.cm-strikethrough { text-decoration: line-through; }
.cm-tw-syntaxerror { color: rgb(255, 255, 255); background-color: rgb(153, 0, 0); }
.cm-tw-deleted { text-decoration: line-through; }
.cm-tw-header5 { font-weight: 700; }
.cm-tw-listitem:first-child { padding-left: 10px; }
.cm-tw-box { border-style: solid; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-color: inherit; border-top-width: 0px !important; }
.cm-tw-underline { text-decoration: underline; }
@media print {
  .CodeMirror div.CodeMirror-cursor { visibility: hidden; }
}


/* Theme adapted from https://codemirror.net/theme/dracula.css */
/*
    Name:       dracula
    Author:     Michael Kaminsky (http://github.com/mkaminsky11)

    Original dracula color scheme by Zeno Rocha (https://github.com/zenorocha/dracula-theme)
*/

.cm-s-inner {
  padding: 0.5rem 0.2rem;
  border: 1px solid var(--accent-color) !important;
  border-radius: 0.25rem;
}

.cm-s-inner.CodeMirror, .cm-s-inner .CodeMirror-gutters {
  background-color: #282a36 !important;
  color: #f8f8f2 !important;
  border: none;
}

.cm-s-inner .CodeMirror-gutters {
  width: 5ch;
  color: #282a36;
}
.cm-s-inner .CodeMirror-cursor { border-left: solid thin #f8f8f2 !important; }
.cm-s-inner .CodeMirror-linenumber {
  width: 4ch !important;
  color: #6D8A88;
}

.cm-s-inner .CodeMirror-line::selection,
.cm-s-inner .CodeMirror-line > span::selection,
.cm-s-inner .CodeMirror-line > span > span::selection { background: rgba(255, 255, 255, 0.10); }
.cm-s-inner .CodeMirror-line::-moz-selection,
.cm-s-inner .CodeMirror-line > span::-moz-selection,
.cm-s-inner .CodeMirror-line > span > span::-moz-selection { background: rgba(255, 255, 255, 0.10); }
.cm-s-inner span.cm-comment { color: #6272a4; }
.cm-s-inner span.cm-string, .cm-s-inner span.cm-string-2 { color: #f1fa8c; }
.cm-s-inner span.cm-number { color: #bd93f9; }
.cm-s-inner span.cm-variable, .cm-s-inner span.cm-variable-2 { color: #50fa7b; }
.cm-s-inner span.cm-def { color: white; }
.cm-s-inner span.cm-operator { color: #ff79c6; }
.cm-s-inner span.cm-keyword { color: #ff79c6; }
.cm-s-inner span.cm-atom { color: #bd93f9; }
.cm-s-inner span.cm-meta { color: #f8f8f2; }
.cm-s-inner span.cm-tag { color: #ff79c6; }
.cm-s-inner span.cm-attribute { color: #50fa7b; }
.cm-s-inner span.cm-qualifier { color: #50fa7b; }
.cm-s-inner span.cm-property { color: #66d9ef; }
.cm-s-inner span.cm-builtin { color: #50fa7b; }
.cm-s-inner span.cm-variable-3, .cm-s-inner span.cm-type { color: #ffb86c; }

.cm-s-inner .CodeMirror-activeline-background { background: rgba(255,255,255,0.1); }
.cm-s-inner .CodeMirror-matchingbracket {
  text-decoration: underline;
  color: white !important;
}
.CodeMirror-selectedtext, .CodeMirror-selected {
  background: #313746 !important;
  text-shadow: none;
}
/* 
  Middle East - Night
  Typora RTL theme
  design: isapanah.com
  date: 2019
  version: 1.1
*/

@import url("file:////home/Taha/.config/Typora/themes/");

/*
  Vazir provided by Rastikerdar
  Downloaded from `https://github.com/rastikerdar/vazir-font`
*/
/*
	Cousine provided by Steve Matteson from Google Fonts
	Downloaded from `https://fonts.google.com/specimen/Cousine`
*/
/** ROOT VARIABLES **/

:root {
  --bg-color: #1e2022; /* change background */
  --text-color: #dddddd; /* change text color */
  --md-char-color: #5b5b5b; /* change color of mbeta characetrs like `*` in markdown */
  --meta-content-color: #757575; /* change color of meta contents like image text or link address in markdown */
  --link-color: #6bcafb; /* change color of hyperlinks */

  --primary-color: #428bca; /* primary color */
  --primary-btn-border-color: #285e8e; /* primary color for buttons */
  --primary-btn-text-color: #fff; /* primary text color for buttons */
  --accent-color: #3c3c3c; /* background accent color */

  --window-border: 1px solid #16161a; /* border for sidebar, etc*/

  --active-file-bg-color: #16161a; /* background color if list item in file tree or file list*/
  --active-file-text-color: inherit; /* text color for selected file */
  --active-file-border-color: #777; /* border color for selected file */
  --active-search-item-bg-color: #212121; /* background color for active search item */

  --side-bar-bg-color: #2b2b2b; /* change background of sidebar*/
  --item-hover-bg-color: var(--bg-color); /* background of control items when hover, like menu in sidebar*/
  --item-hover-text-color: white; /* text color upon hovering over menu items */
  --search-hit-bg-color: #428bca40;
  --search-select-text-color: var(--text-color); /* Text color for selected searched text */
  --search-select-bg-color: #428bca90; /* Background color for selected searched text */
  --rawblock-edit-panel-bd: var(--accent-color); /* Background color for inline HTML "edit panel" blocks */
  --monospace: "Cousine"; /* monospace font for codes, fences */

  --megamenu-bg-color: var(--side-bar-bg-color); /* background color for unibody megamenu */
  --megamenu-sidebar-bg-color: var(--bg-color); /* background color for megamenu sidebar */
  --megamenu-sidebar-hover-bg-color: #161819; /* background color for hovering megamenu sidebar items */
  --megamenu-sidebar-active-bg-color: #101010; /* background color for active megamenu sidebar items */
  --megamenu-button-border-color: #9292928f; /* background color for megamenu buttons */
  --megamenu-item-hover-bg-color: var(--bg-color); /* background color for hovering megamenu items */
  --megamenu-item-hover-text-color: white; /* text color for hovering megamenu items */
}

/** TAGS **/

html,
body {
  font-family: "Vazir", "Lato", sans-serif;
}

body {
  font-size: 14px;
}

h1,
h2,
h3,
h4,
h5,
h6, p, a, del, mark, #write p, #write a, #write del, #write mark, #write ul, #write li, #write ol,
#write table, #write tr, #write td, table, tr, td {
  direction: rtl;
}

.outline-item{
  direction: rtl;
}
.outline-h2, .outline-h3, .outline-h4,
 .outline-h5, .outline-h6 {
  margin-right: 10px !important;
}

#md-notification, #md-notification *{
  direction: ltr;
}

h1,
h2,
h3,
h4,
h5,
h6 {
  font-family: "Vazir-Bold";
}

h1 {
  font-size: 1.8rem;
  margin: 1rem 0;
}

h2 {
  font-size: 1.4rem;
  margin: 0.7rem 0;
}

h3 {
  font-size: 1.2rem;
  margin: 0.5rem 0;
}

h4 {
  font-size: 1.1rem;
  margin: 0.2rem 0;
}

h5 {
  font-size: 1rem;
  margin: 0;
}

h6 {
  font-size: 1rem;
  margin: 0;
}

p {
  margin: 0.5rem 0;
}

a {
  color: var(--link-color);
}

del {
  color: var(--md-char-color);
}

mark {
  padding: 2px 1px;
  background: #fee405;
}

/* Writing area -> line height */
#write {
	line-height: 1.6;
}

/* Custom list-style */
#write ol,
#write ul {
  padding-left: 2rem;
  margin: 0.5rem 0;
  margin-left: 0 !important;
  padding-left: 0 !important;
}

#write ul {
  list-style-type: disc;
}

#write ol > li,
#write ul > li {
  color: var(--primary-color);
  padding-left: 0.25em;
}

#write ol li > *,
#write ul li > * {
  color: var(--text-color);
}

#write .md-task-list-item {
  transition: all 0.3s;
}

#write .md-task-list-item > input {
  -webkit-appearance: initial;
  display: block;
  position: absolute;
  border: 1px solid var(--md-char-color);
  border-radius: 0.25rem;
  margin-top: 0.1rem;
  margin-right: -1.8rem;
  height: 1.2rem;
  width: 1.2rem;
  transition: background 0.4s;
  right: 0;
}

#write .md-task-list-item > input:focus {
  outline: none;
  box-shadow: none;
}

#write .md-task-list-item > input:hover {
  background: var(--accent-color);
}

#write .md-task-list-item.task-list-done > p {
  color: var(--md-char-color);
  text-decoration: line-through;
}

#write .md-task-list-item > input[checked]::before {
  content: "";
  position: absolute;
  top: 20%;
  left: 50%;
  height: 60%;
  width: 2px;
  transform: rotate(40deg);
  background: var(--text-color);
}

#write .md-task-list-item > input[checked]::after {
  content: "";
  position: absolute;
  top: 46%;
  left: 25%;
  height: 30%;
  width: 2px;
  transform: rotate(-40deg);
  background: var(--text-color);
}

blockquote {
  margin: 1rem 0rem 1rem 0;
  font-family: "Vazir-Bold";
}

blockquote p::before {
  content: "";
  position: absolute;
  right: -2rem;
  height: 100%;
  width: 0.25rem;
  background: var(--primary-color);
}

blockquote p:not(:last-child):before {
  height: calc(100% + 1rem);
}

code,
.md-fences,
tt {
  font-family: "Cousine", monospace;
  font-size: 1rem;
}

code {
  border: 1px solid var(--accent-color);
  border-radius: 0.25rem;
  padding: 0 0.125rem;
}

/* Code auto-suggest list menu */
#fences-auto-suggest .active {
  background: var(--accent-color);
}

hr {
  border-color: var(--md-char-color);
}

/* YAML */
pre.md-meta-block {
  background-color: transparent;
  border-bottom: 1px solid var(--md-char-color);
  padding-bottom: 1rem;
  opacity: 0.8;
}

/* Tables */
table {
  border: 1px solid var(--md-char-color);
  margin: 1rem 0;
}

thead {
  background: #4d4d4d;
}

table tr:nth-child(2n) {
  background: var(--accent-color);
}

td,
th {
  padding: 0.35rem 0.7rem;
  border: 1px solid var(--md-char-color);
}

/* Table toolbar */
.md-table-edit {
  border-top: 1px solid var(--meta-content-color);
  margin-top: -29px !important;
  padding: 3px 0;
}

/* Table drag areas */
.typora-table-drag-area::after {
  content: "";
  position: absolute;
  border: 2px solid var(--text-color);
  opacity: 0;
  transition: opacity 0.4s;
}

#typora-table-row-tracker .typora-table-drag-area::after {
  top: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 0;
  height: 100%;
}

#typora-table-col-tracker .typora-table-drag-area::after {
  top: 50%;
  left: 0;
  transform: translateY(-50%);
  width: 100%;
  height: 0;
}

#typora-table-row-tracker .typora-table-drag-area:hover::after,
#typora-table-col-tracker .typora-table-drag-area:hover::after {
  opacity: 1;
}

/* Table of contents */
.md-toc-tooltip {
  z-index: 10;
}

span.md-toc-item {
  font-size: 1.1rem;
  color: var(--primary-btn-border-color);
}

span.md-toc-h1 {
  font-family: "Vazir-Bold";
  font-size: 1.3rem;
}

span.md-toc-h2 {
  font-size: 1.2rem;
}

/* Footnote */
sup.md-footnote {
  font-family: "Vazir-Bold";
  font-size: 0.8rem;
  padding: 0 4px;
}

span.md-def-split {
  min-width: 1ch;
}

.md-def-name::before,
.md-def-name::after {
  color: var(--meta-content-color);
}

/* Writing area */
#write {
  width: 90%;
  max-width: 700px;
}

/* Fill whole width of container */
#write h1,
#write h2,
#write h3,
#write h4,
#write h5,
#write h6,
#write p,
#write pre {
  width: auto;
}

/* Header prefix symbol */
/* Disable default header symbol */
#write h3.md-focus::before,
#write h4.md-focus::before,
#write h5.md-focus::before,
#write h6.md-focus::before {
  border: none;
  border-radius: 0;
  left: auto;
  float: none;
  padding: 0;
  vertical-align: baseline;
  line-height: 20px;
}

#write h1::before,
#write h2::before,
#write h3::before,
#write h4::before,
#write h5::before,
#write h6::before {
  position: absolute;
  top: 0;
  right: calc(100% + 10px);
  color: var(--md-char-color);
  font-size: 1rem;
  font-weight: bold;
  font-variant: "small-caps";
}

#write h1::before {
  content: "H1";
  top: 0.7rem;
}

#write h2::before {
  content: "H2";
  top: 0.37rem;
}

#write h3::before {
  content: "H3";
  top: 0.15rem;
}

#write h4::before {
  content: "H4";
}

#write h5::before {
  content: "H5";
}

#write h6::before {
  content: "H6";
}

/* Image meta text */
#write .md-image > .md-meta {
  color: var(--meta-content-color);
}

/* Inline styles */
.md-rawblock-tooltip {
  top: -1.5rem;
  height: 1.5rem;
  padding: 0.25rem;
}

/* Search results */
.md-search-hit {
  background: var(--search-hit-bg-color);
  border-radius: 0.125em;
}

.md-search-select {
  background: var(--search-select-bg-color);
  border: 1px solid var(--megamenu-button-border-color);
  padding: 0 1px;
}

/* Focus mode */
.on-focus-mode .md-end-block:not(.md-focus):not(.md-focus-container) *,
.on-focus-mode pre.md-end-block:not(.md-focus):not(.md-focus-container) {
  color: var(--md-char-color) !important;
}

.on-focus-mode .md-end-block:not(.md-focus):not(.md-focus-container) img,
.on-focus-mode
  blockquote
  .md-end-block:not(.md-focus):not(.md-focus-container)::before,
.on-focus-mode li:not(.md-focus-container)::before {
  opacity: 0.5;
}

.on-focus-mode .md-end-block:not(.md-focus):not(.md-focus-container) mark {
  background: var(--accent-color);
}

/* UI Sidebar */
#typora-sidebar {
  border-right: 1px solid #19191c;
}

.sidebar-tabs {
  font-family: "Vazir-Bold";
  border-bottom: 1px solid black;
}

.file-list-item-file-name {
  font-family: "Vazir-Bold";
  font-size: 1.2rem;
}

input.file-list-item-file-name, input.file-tree-rename-input {
  background: var(--side-bar-bg-color);
}

#file-library-search .file-list-item-file-name {
  font-size: 1.1rem;
}

#file-library-search .ty-search-item.active {
  background: var(--active-search-item-bg-color);
}

#file-library-search-input {
  background: var(--side-bar-bg-color);
}

.file-list-item-summary,
.ty-search-item-line {
  font-family: "Vazir", "Lato", sans-serif;
}

.ty-file-search-match-text,
.ty-outline-hit {
  font-weight: bold;
  background: transparent;
}

#outline-content {
  line-height: 1.4em;
}

#outline-content .outline-h1 > .outline-item {
  font-family: "Vazir-Bold";
}

.file-library-node,
.file-library-node .file-node-background {
  transition: background 0.4s;
}

.file-tree-node.file-library-file-node:not(.active):hover .file-node-background,
.file-list-item.file-library-node:not(.active):hover {
  background: var(--item-hover-bg-color);
}

.file-tree-node.file-library-file-node.active .file-node-background,
.file-list-item.file-library-file-node.active {
  border-left: 5px solid var(--primary-color);
}

/* Remove blinking animation when updating filename */
.blink-area {
  animation: none;
}

#ty-sidebar-footer {
  border-top: 1px solid black;
}

.sidebar-footer-item {
  transition: background 0.3s;
}

.outline-title-wrapper,
.outline-item-wrapper.outline-h1 > .outline-item {
  font-family: "Vazir-Bold";
  font-weight: bold;
}

/* Windows-specific */
/* Context and dropdown menus */
ul.dropdown-menu li.active a,
ul.dropdown-menu li.has-extra-menu.active a,
ul.dropdown-menu li.has-btn-submenu a.menu-style-btn.active,
#footer-word-count-info .ty-footer-word-count-all tr:hover,
#ty-spell-check-dict-missing-menu li:hover,
.ty-spell-check-panel-item.ty-active,
.ty-spell-check-panel-item:hover {
  background: var(--text-color) !important;
  color: var(--bg-color) !important;
}

/* Windows Unibody */
footer.ty-footer {
  border-top: 0;
}

.footer-item:hover {
  background: var(--text-color) !important;
  color: var(--bg-color) !important;
}

.form-control:focus {
  border-color: var(--primary-color);
  box-shadow: inset 0 1px 1px rgba(0,0,0,.075), 0 0 2px var(--primary-color);
}

/* Windows Unibody megamenu */
.megamenu-opened header {
  background-image: none;
}

#top-titlebar, #top-titlebar * {
  color: inherit;
}

#megamenu-content {
  padding-top: 28px;
  background: var(--megamenu-bg-color);
  color: var(--text-color);
}

.megamenu-menu-panel:not(:first-of-type) {
  margin-top: 48px;
}

#megamenu-content .long-btn {
  border-color: var(--megamenu-button-border-color);
  transition: all 0.4s;
}

#megamenu-content .long-btn:hover {
  border-color: var(--primary-color);
  background: var(--megamenu-item-hover-bg-color);
  color: var(--megamenu-item-hover-text-color) !important;
}

#recent-file-panel-action-btn {
  background: inherit;
  border-color: var(--megamenu-button-border-color);
  transition: all 0.4s;
}

#recent-file-panel-action-btn:hover {
  border-color: var(--primary-color);
  background: var(--megamenu-item-hover-bg-color);
  color: var(--megamenu-item-hover-text-color);
}

#recent-document-table {
  border: 1px solid var(--accent-color);
}

#recent-file-panel tbody tr:nth-child(2n-1) {
  background-color: inherit;
}

#recent-file-panel tbody tr:hover {
  background-color: var(--megamenu-item-hover-bg-color) !important;
}

#recent-file-panel tbody tr:hover td:nth-child(1) {
  color: var(--megamenu-item-hover-text-color);
}

/* Windows Unibody sidebar */
#megamenu-menu-sidebar {
  background: var(--megamenu-sidebar-bg-color);
  color: var(--text-color);
}

.megamenu-menu-header, .megamenu-menu-list li:not(.saved) a {
  transition: all 0.4s;
}

.megamenu-menu-header {
  border-bottom: var(--window-border);
}

.megamenu-menu-header:hover, .megamenu-menu-list li:not(.saved) a:not(.active):hover {
  background: var(--megamenu-sidebar-hover-bg-color);
}

.megamenu-menu-list li a.active {
  background: var(--megamenu-sidebar-active-bg-color) !important;
}

#m-saved {
  background: inherit;
  color: inherit;
}

#megamenu-menu-list {
  margin: 0;
}

.theme-preview-div {
  transition: all 0.4s;
}

.theme-preview-div:hover {
  border: 4px solid var(--primary-btn-border-color);
}

.theme-preview-div.active, .theme-preview-div.active:hover {
  border: 4px solid var(--primary-color);
}

.theme-preview-div.active i {
  color: var(--primary-color);
}

/* Source Code */
.cm-s-typora-default .cm-s-inner.CodeMirror-line {
  border: 0 !important;
}

/* Print/PDF */
@media print {
  #write ol > li,
  #write ul > li {
    color: var(--text-color);
  }
  #write h1::before, #write h2::before, #write h3::before,
  #write h4::before, #write h5::before, #write h6::before {
    display: none;
  }
}




mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
  min-height: 1px;
  min-width: 1px;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

mjx-container[jax="SVG2"] path[data-c], mjx-container[jax="SVG2"] use[data-c] {
  stroke-width: 3;
}

g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

.MathJax g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}
mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
							stroke-width: 0;
						}
</style><title></title>
</head>
<body class='typora-export'><div class='typora-export-content'>
<div id='write'  class=''><p>&nbsp;</p><h3 id='amazon-elastic-compute-cloud-ec2-و-amazon-elastic-block-store-ebs'><strong><span>Amazon Elastic Compute Cloud (EC2) و Amazon Elastic Block Store (EBS)</span></strong></h3><h4 id='أهداف-امتحان-aws-certified-solutions-architect-associate-اللي-الشابتر-ده-هيغطيها-ممكن-تشمل-بس-مش-محصورة-في-الآتي'><strong><span>أهداف امتحان AWS Certified Solutions Architect Associate اللي الشابتر ده هيغطيها ممكن تشمل (بس مش محصورة في) الآتي:</span></strong></h4><hr /><ul><li><p><span>✅ </span><strong><span>Domain 1: تصميم Architectures مرنة وقادرة على التحمل (Resilient)</span></strong></p><ul><li><p><strong><span>1.1</span></strong><span> تصميم حل </span><code>architecture</code><span> متكون من كذا </span><code>tier</code><span> (طبقة).</span></p></li><li><p><strong><span>1.2</span></strong><span> تصميم </span><code>architectures</code><span> عندها </span><code>high availability</code><span> (يعني صعب تقع) و/أو </span><code>fault-tolerant</code><span> (بتستحمل الأعطال).</span></p></li><li><p><strong><span>1.4</span></strong><span> اختيار </span><code>storage</code><span> مناسب و</span><code>resilient</code><span> (يعني بيستحمل ومبيضعش الداتا).</span></p></li></ul></li><li><p><span>✅ </span><strong><span>Domain 2: تصميم Architectures  (High-Performing)</span></strong></p><ul><li><p><strong><span>2.1</span></strong><span> تحديد حلول </span><code>compute</code><span> تكون </span><code>elastic</code><span> (مرنة) و </span><code>scalable</code><span> (قابلة للتوسع) عشان تناسب أي </span><code>workload</code><span>.</span></p></li><li><p><strong><span>2.2</span></strong><span> اختيار حلول </span><code>storage</code><span> تكونHigh-Performing  و</span><code>scalable</code><span> عشان تناسب أي </span><code>workload</code><span>.</span></p></li></ul></li><li><p><span>✅ </span><strong><span>Domain 3: تصميم Applications و Architectures آمنة</span></strong></p><ul><li><p><strong><span>3.1</span></strong><span> تصميم </span><code>access</code><span> آمن للـ </span><code>AWS resources</code><span>.</span></p></li></ul></li><li><p><span>✅ </span><strong><span>Domain 4: تصميم Architectures موفرة في التكاليف (Cost-Optimized)</span></strong></p><ul><li><p><strong><span>4.1</span></strong><span> تحديد حلول </span><code>storage</code><span> موفرة في التكاليف.</span></p></li><li><p><strong><span>4.2</span></strong><span> تحديد خدمات </span><code>compute</code><span> و </span><code>database</code><span> موفرة في التكاليف.</span></p></li><li><p><strong><span>4.3</span></strong><span> تصميم </span><code>network architectures</code><span> موفرة في التكاليف.</span></p></li></ul></li></ul><p>&nbsp;</p><h2 id='مقدمة'><strong><span>مقدمة</span></strong></h2><p><span>قلب أي </span><code>data center</code><span> أو أوضة سيرفرات عادية هو السيرفرات الغالية اللي جواها. بس عشان تخلي السيرفرات دي مفيدة، أنت هتحتاج تزود عليها </span><code>racks</code><span>، و </span><code>power supplies</code><span>، وكابلات، و </span><code>switches</code><span>، و </span><code>firewalls</code><span>، وتبريد.</span></p><p><span>الخدمة بتاعت AWS اللي اسمها </span><strong><span>Elastic Compute Cloud (EC2)</span></strong><span> معمولة عشان تعملك نفس تجربة الـ </span><code>data center</code><span> أو أوضة السيرفرات دي بأقرب شكل ممكن. الأساس في كل ده هو السيرفر الـ </span><code>virtual</code><span> بتاع EC2، واللي بنسميه </span><strong><code>instance</code></strong><span>. بس زي أوضة السيرفرات العادية اللي لسه وصفناها، EC2 بتقدملك مجموعة أدوات معمولة عشان تدعم وتحسّن شغل الـ </span><code>instance</code><span> بتاعتك.</span></p><p><span>الشابتر ده هيوريك الأدوات والطرق اللي بتستخدمها عشان تستفيد من قوة المنظومة بتاعت EC2 لأقصى درجة، زي الحاجات دي:</span></p><ul><li><p><span>✅ إزاي تجهّز (</span><code>provision</code><span>) </span><code>EC2 instance</code><span> بالـ </span><code>hardware resources</code><span> الصح لمشروعك.</span></p></li><li><p><span>✅ إزاي تظبط الـ </span><code>operating system</code><span> الأساسي الصح اللي الـ </span><code>application</code><span> بتاعك محتاجه.</span></p></li><li><p><span>✅ إزاي تبني بيئة </span><code>network</code><span> آمنة وفعالة للـ </span><code>instance</code><span> بتاعتك.</span></p></li><li><p><span>✅ إزاي تضيف </span><code>scripts</code><span> تشتغل أول ما الـ </span><code>instance</code><span> تقوم عشان تساعد (أو تبدأ) الـ </span><code>application</code><span> بتاعك.</span></p></li><li><p><span>✅ إزاي تختار أحسن نظام تسعير (</span><code>pricing model</code><span>) لـ EC2 على حسب احتياجاتك.</span></p></li><li><p><span>✅ إزاي تفهم وتستفيد من دورة حياة الـ </span><code>instance</code><span> (</span><code>EC2 instance lifecycle</code><span>).</span></p></li><li><p><span>✅ إزاي تختار نوع الـ </span><code>storage drive</code><span> الصح لاحتياجاتك.</span></p></li><li><p><span>✅ إزاي تأمّن الـ </span><code>EC2 resources</code><span> بتاعتك باستخدام </span><code>key pairs</code><span>، و </span><code>security groups</code><span>، و </span><code>network access lists</code><span>، والـ </span><code>IAM roles</code><span>.</span></p></li><li><p><span>✅ إزاي تزود وتقلل عدد الـ </span><code>instances</code><span> عشان تواكب الطلب المتغير باستخدام الـ </span><code>Auto Scaling</code><span>.</span></p></li><li><p><span>✅ إزاي تعمل </span><code>access</code><span> على الـ </span><code>instance</code><span> بتاعتك كـ </span><code>administrator</code><span> أو كـ </span><code>end-user</code><span>.</span></p></li></ul><p>&nbsp;</p><h2 id='الـ-ec2-instances'><strong><span>الـ EC2 Instances</span></strong></h2><p><span>الـ </span><strong><span>EC2 instance</span></strong><span> ممكن تكون مجرد حتة متاخدة بشكل </span><code>virtual</code><span> من </span><code>physical server</code><span> حقيقي، بس هي بتتصرف كأنها حاجة حقيقية بالظبط. هيبقى ليها </span><code>access</code><span> على </span><code>storage</code><span> و </span><code>memory</code><span> و </span><code>network interface</code><span>، والـ </span><code>hard drive</code><span> الأساسي بتاعها هييجي وعليه </span><code>operating system</code><span> نضيف وجاهز.</span></p><p><span>أنت اللي بتقرر نوع الـ </span><code>hardware resources</code><span> اللي عايز الـ </span><code>instance</code><span> بتاعتك تاخدها، وإيه الـ </span><code>operating system</code><span> والـ </span><code>software</code><span> اللي عايزها تشغله، وفي الآخر، هتدفع عليها كام. تعال نشوف بقى كل ده بيشتغل إزاي.</span></p><h4 id='تجهيز-الـ-instance-بتاعتك-provisioning'><strong><span>تجهيز الـ Instance بتاعتك (Provisioning)</span></strong></h4><p><span>أنت بتظبط الـ </span><code>operating system</code><span> والـ </span><code>software</code><span>، ومواصفات الـ </span><code>hardware</code><span> (قوة الـ CPU، الـ memory، الـ storage الأساسي، وأداء الـ network)، والبيئة بتاعت الـ </span><code>instance</code><span> قبل ما تعملها </span><code>launch</code><span> (تشغيل). الـ OS بيتحدد بالـ </span><strong><span>Amazon Machine Image (AMI)</span></strong><span> اللي بتختاره، والـ </span><code>hardware</code><span> بيمشي تبع الـ </span><strong><span>instance type</span></strong><span>.</span></p><h4 id='الـ-amazon-machine-images-amis-بتاعة-ec2'><strong><span>الـ Amazon Machine Images (AMIs) بتاعة EC2</span></strong></h4><p><span>الـ </span><strong><span>AMI</span></strong><span> ده في الحقيقة مجرد </span><strong><span>template</span></strong><span> فيه معلومات بتقول لـ EC2 إيه هو الـ OS والـ </span><code>software</code><span> اللي يحطه على الـ </span><code>root data volume</code><span> بتاع الـ </span><code>instance</code><span> اللي هيشغلها. في أربع أنواع من الـ AMIs:</span></p><ul><li><p><strong><span>Amazon Quick Start AMIs:</span></strong>
<span>الـ </span><code>images</code><span> دي بتظهر في وشك أول القايمة في الـ </span><code>console</code><span> لما تبدأ تعمل </span><code>launch</code><span> لـ </span><code>instance</code><span> جديدة. هي الاختيارات المشهورة وبتشمل إصدارات مختلفة من Linux أو Windows Server، وشوية </span><code>images</code><span> متخصصة عشان تعمل عمليات معينة (زي الـ </span><code>deep learning</code><span> أو الـ </span><code>database</code><span>). الـ AMIs دي متحدثة ومدعومة رسميًا </span></p></li><li><p><strong><span>AWS Marketplace AMIs:</span></strong>
<span>الـ AMIs اللي من الـ </span><code>AWS Marketplace</code><span> دي </span><code>images</code><span> رسمية وجاهزة للإنتاج (</span><code>production-ready</code><span>)، ومقدمة ومدعومة من شركات كبيرة في المجال زي SAP و Cisco.</span></p></li><li><p><strong><span>Community AMIs:</span></strong>
<span>في أكتر من 100 ألف </span><code>image</code><span> متاحة كـ </span><code>community AMIs</code><span>. كتير من الـ </span><code>images</code><span> دي معمولة ومتصانة من مطورين مستقلين وغالبًا بتبقى معمولة عشان تسد احتياج معين. ده كتالوج كويس تدور فيه لو أنت بتخطط تعمل </span><code>application</code><span> مبني على توليفة </span><code>software</code><span> معينة.</span></p></li><li><p><strong><span>Private AMIs:</span></strong>
<span>أنت كمان تقدر تحفظ الـ </span><code>images</code><span> اللي بتعملها من الـ </span><code>instance</code><span> بتاعتك كـ </span><code>private AMIs</code><span>. طب ليه ممكن تعمل كده؟ مثلاً، ممكن تكون عايز تزود عدد الـ </span><code>instances</code><span> اللي شغالة عشان تواجه الطلب الزيادة. لما يكون عندك </span><code>instance image</code><span> موثوقة ومتجربة ومتحدثة كـ AMI، موضوع الـ </span><code>autoscaling</code><span> بيبقى سهل. تقدر كمان تشارك الـ </span><code>images</code><span> دي أو تعمل </span><code>import</code><span> لـ </span><code>VMs</code><span> من الـ </span><code>infrastructure</code><span> اللي عندك على الأرض (عن طريق S3) باستخدام أداة </span><code>AWS VM Import/Export</code><span>.</span></p></li></ul><div class="md-alert md-alert-important important"><p><span class='md-alert-text md-alert-text-important'><svg viewBox="0 0 16 16" version="1.1" width="1em" height="1em" aria-hidden="true"><path d="M0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v9.5A1.75 1.75 0 0 1 14.25 13H8.06l-2.573 2.573A1.458 1.458 0 0 1 3 14.543V13H1.75A1.75 1.75 0 0 1 0 11.25Zm1.75-.25a.25.25 0 0 0-.25.25v9.5c0 .138.112.25.25.25h2a.75.75 0 0 1 .75.75v2.19l2.72-2.72a.749.749 0 0 1 .53-.22h6.5a.25.25 0 0 0 .25-.25v-9.5a.25.25 0 0 0-.25-.25Zm7 2.25v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 9a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path></svg>Important</span><br><span>أي AMI بتبقى متاحة في </span><strong><code>region</code><span> واحدة بس</span></strong><span> — مع إنك غالبًا هتلاقي </span><code>images</code><span> بتعمل نفس الشغلانة في كل الـ </span><code>regions</code><span>. خلي بالك من الحتة دي وإنت بتخطط للـ </span><code>deployments</code><span> بتاعتك: لو ناديت على الـ ID بتاع AMI في </span><code>region</code><span> معينة وإنت شغال في </span><code>region</code><span> تانية، العملية هتفشل.</span></p></div><p>&nbsp;</p><div class="md-alert md-alert-warning warning"><p><span class='md-alert-text md-alert-text-warning'><svg viewBox="0 0 16 16" version="1.1" width="1em" height="1em" aria-hidden="true"><path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path></svg>Warning</span><br></p><p><span>غير المصاريف العادية عشان تشغل </span><code>EC2 instance</code><span>، الـ </span><code>account</code><span> بتاعك على AWS ممكن يتحاسب كمان بمبالغ بالساعة أو مصاريف ترخيص (</span><code>license fees</code><span>) عشان تستخدم الـ </span><code>software</code><span> اللي جوه الـ AMI نفسه.</span></p><p><span>مع إن الشركات اللي بتقدم الـ AMIs دي بتحاول بكل الطرق توضح المصاريف بتاعتها، بس في الآخر دي </span><strong><span>مسؤوليتك أنت</span></strong><span> إنك توافق على المصاريف دي وتدفعها.</span></p></div><p>&nbsp;</p><h3 id='أنواع-الـ-instances-instance-types'><strong><span>أنواع الـ Instances (Instance Types)</span></strong></h3><p><span>AWS بتخصص الـ </span><code>hardware resources</code><span> للـ </span><code>instances</code><span> بتاعتك على حسب الـ </span><strong><code>instance type</code></strong><span> — أو زي ما بنقول الـ </span><code>hardware profile</code><span> — اللي أنت بتختاره. الـ </span><code>workload</code><span> اللي أنت بتخططله هو اللي بيحدد النوع اللي هتختاره.</span></p><p><span>الفكرة كلها إنك تعمل </span><strong><span>توازن بين التكلفة واحتياجك</span></strong><span> لقوة الـ </span><code>compute</code><span> والـ </span><code>memory</code><span> ومساحة الـ </span><code>storage</code><span>. المفروض إنك تلاقي نوع بيديلك بالظبط الكمية اللي أنت محتاجها من كل حاجة عشان ترضي الـ </span><code>application</code><span> بتاعك والميزانية بتاعتك في نفس الوقت.</span></p><p><span>ولو احتياجاتك اتغيرت مع الوقت، تقدر بسهولة تنقل لـ </span><code>instance type</code><span> مختلف. كل اللي هتعمله إنك توقف الـ </span><code>instance</code><span> بتاعتك، وتعدل الـ </span><code>instance type</code><span> بتاعها، وتشغلها تاني.</span></p><p><span>زي ما باين في جدول 2.1، حاليًا في أكتر من 75 </span><code>instance type</code><span> متقسمين على خمس عائلات </span><code>instances</code><span> (instance families)، مع إن AWS بتحدّث الاختيارات دي على طول. تقدر تشوف أحدث تشكيلة على اللينك ده: </span><code>aws.amazon.com/ec2/instance-types</code><span>.</span></p><h3 id='جدول-21-عائلات-الـ-ec2-instance-types-والأنواع-اللي-تحتها'><strong><span>جدول 2.1: عائلات الـ EC2 instance types والأنواع اللي تحتها</span></strong></h3><figure class='table-figure'><table><thead><tr><th style='text-align:left;' ><span>الـ Instance type family (عائلة الـ instance)</span></th><th style='text-align:left;' ><span>الأنواع (Types)</span></th><th style='text-align:left;' ><span>شرح بسيط</span></th></tr></thead><tbody><tr><td style='text-align:left;' ><strong><span>General purpose (للأغراض العامة)</span></strong></td><td style='text-align:left;' ><span>A1, T3, T3a, T2, M6g, M5, M5a, M5n, M4</span></td><td style='text-align:left;' ><span>دي بتدي توازن كويس بين الـ CPU والـ Memory. مناسبة لمعظم الشغل العادي زي الـ web servers الصغيرة والتطبيقات البسيطة.</span></td></tr><tr><td style='text-align:left;' ><strong><span>Compute optimized (مخصصة للـ Compute)</span></strong></td><td style='text-align:left;' ><span>C5, C5n, C4</span></td><td style='text-align:left;' ><span>دي بتديلك CPU قوي جدًا مقارنة بالـ Memory. ممتازة للحاجات اللي محتاجة معالجة حسابية تقيلة زي الـ </span><code>batch processing</code><span> والـ </span><code>media transcoding</code><span>.</span></td></tr><tr><td style='text-align:left;' ><strong><span>Memory optimized (مخصصة للـ Memory)</span></strong></td><td style='text-align:left;' ><span>R5, R5a, R5n, X1e, X1, High Memory, z1d</span></td><td style='text-align:left;' ><span>دي بتديلك Memory كتير أوي مقارنة بالـ CPU. ممتازة للحاجات اللي بتستهلك memory جامد زي الـ </span><code>databases</code><span> الكبيرة والـ </span><code>caching</code><span>.</span></td></tr><tr><td style='text-align:left;' ><strong><span>Accelerated computing </span></strong></td><td style='text-align:left;' ><span>P3, P2, Inf1, G4, G3, F1</span></td><td style='text-align:left;' ><span>دي فيها </span><code>hardware accelerators</code><span> زي كروت الشاشة (GPUs). بتستخدم في حاجات زي الـ </span><code>machine learning</code><span> والـ </span><code>graphics rendering</code><span>.</span></td></tr><tr><td style='text-align:left;' ><strong><span>Storage optimized (مخصصة للـ Storage)</span></strong></td><td style='text-align:left;' ><span>I3, I3en, D2, H1</span></td><td style='text-align:left;' ><span>دي بتديلك </span><code>storage</code><span> سريع جدًا على الـ </span><code>instance</code><span> نفسها. ممتازة للـ </span><code>databases</code><span> اللي محتاجة سرعة قراءة وكتابة عالية أوي وللـ </span><code>data warehousing</code><span>.</span></td></tr></tbody></table></figure><p>&nbsp;</p><h4 id='general-purpose-للأغراض-العامة'><strong><span>General Purpose (للأغراض العامة)</span></strong></h4><p><span>عائلة الـ </span><code>General Purpose</code><span> فيها أنواع زي T3, T2, M5, M4، ودي كلها هدفها تديلك توازن حلو بين الـ </span><code>compute</code><span> والـ </span><code>memory</code><span> والـ </span><code>network</code><span>.</span></p><ul><li><p><span>أنواع الـ </span><strong><span>T2</span></strong><span> مثلاً، بتبدأ من الـ </span><code>t2.nano</code><span> اللي فيه واحد </span><code>vCPU</code><span> ونص جيجا </span><code>memory</code><span>، لحد الـ </span><code>t2.2xlarge</code><span> اللي فيه 8 </span><code>vCPUs</code><span> و 32 جيجا </span><code>memory</code><span>. وعشان الـ </span><code>t2.micro</code><span> داخل في الـ </span><code>Free Tier</code><span> (الخطة المجانية)، فهو دايمًا اختيار كويس لو لسه بتجرب. بس عادي جدًا تستخدمه لمواقع خفيفة أو شغلانات تطوير بسيطة.</span></p></li><li><p><span>الـ </span><code>instances</code><span> اللي من نوع </span><strong><span>M5 و M4</span></strong><span> كويسين أوي للشغلانات المتوسطة اللي بتعتمد على الداتا. وعكس الـ T2 اللي لازمها </span><code>storage</code><span> من نوع </span><code>EBS</code><span> ، في أنواع من الـ M بتيجي ومعاها</span>
<span> </span><code>instance storage drives</code><span> بتاعتها، ودي بتبقى متوصلة فعليًا بالـ </span><code>host server</code><span> نفسه(ebs مش متوصلة فعليا فى host). أنواع الـ M5 بتبدأ من </span><code>m5.large</code><span> (2 vCPUs و 8 GB memory) لحد الوحش </span><code>m5d.metal</code><span> (96 vCPUs و 384 GB memory).</span></p></li></ul><h4 id='compute-optimized-مخصصة-للـ-compute'><strong><span>Compute Optimized (مخصصة للـ Compute)</span></strong></h4><p><span>للـ </span><code>web servers</code><span> اللي عليها ضغط جامد والـ </span><code>workloads</code><span> التقيلة بتاعت الـ </span><code>machine learning</code><span>، هتختار من عيلة الـ </span><strong><code>Compute Optimized</code></strong><span> اللي فيها أنواع زي C5 و C4. الأجهزة الـ C5 — اللي بتبدأ من </span><code>c5.large</code><span> لحد </span><code>c5d.24xlarge</code><span> — بتديلك سرعة </span><code>processor</code><span> بتوصل لـ 3.5 GHz و </span><code>network bandwidth</code><span> قوي جدًا.</span></p><h4 id='memory-optimized-مخصصة-للـ-memory'><strong><span>Memory Optimized (مخصصة للـ Memory)</span></strong></h4><p><span>الـ </span><code>instances</code><span> الـ </span><strong><code>Memory Optimized</code></strong><span> دي بتشتغل زي الفل مع الـ </span><code>databases</code><span> التقيلة، وعمليات تحليل الداتا، والـ </span><code>caching</code><span>. أنواع زي X1e, X1, و R4 ممكن تلاقي فيها </span><code>memory</code><span> توصل لـ 3.9 تيرابايت، ومعاها </span><code>storage</code><span> من نوع </span><code>SSD</code><span> سريع أوي.</span></p><h4 id='accelerated-computing'><strong><span>Accelerated Computing </span></strong></h4><p><span>تقدر تاخد أداء </span><code>GPU</code><span> عالي جدًا من أنواع زي P3, P2, G3, و F1 اللي في مجموعة الـ </span><strong><code>Accelerated Computing</code></strong><span>. الـ </span><code>instances</code><span> دي بتستخدم أجيال مختلفة من كروت شاشة NVIDIA القوية، أو في حالة الـ F1، حاجة اسمها </span><code>FPGA</code><span> (ولو أنت متعرفش إيه دي، يبقى غالبًا مش محتاجها FPGA دي قصة كفاح بالنسبة ليه). الـ </span><code>instances</code><span> دي ممتازة للـ </span><code>workloads</code><span> التقيلة زي الـ </span><code>3D visualizations</code><span> والـ </span><code>rendering</code><span>، والتحليل المالي، وحسابات ديناميكا الموائع.</span></p><h4 id='storage-optimized-مخصصة-للـ-storage'><strong><span>Storage Optimized (مخصصة للـ Storage)</span></strong></h4><p><span>عيلة الـ </span><strong><code>Storage Optimized</code></strong><span> اللي فيها حاليًا أنواع زي H1, I3, و D2، بيبقى معاها </span><code>instance storage</code><span> كبير وسريع جدًا (وفي حالة الـ I3en، ممكن توصل لـ 60 تيرابايت من </span><code>storage</code><span> نوعه </span><code>HDD</code><span> الأبطأ شوية). الـ </span><code>instances</code><span> دي بتشتغل كويس أوي مع الـ </span><code>distributed filesystems</code><span> والـ </span><code>applications</code><span> اللي بتعمل معالجة داتا تقيلة.</span></p><p><span>التفاصيل وأسماء الأنواع دي هتتغير على طول عشان AWS بتفضل تستخدم تكنولوجيا جديدة عشان تسد احتياجات العملاء اللي بتكبر. بس مهم على الأقل تبقى عارف العائلات دي وطريقة التسمية اللي AWS بتستخدمها.</span></p><div class="md-alert md-alert-tip tip"><p><span class='md-alert-text md-alert-text-tip'><svg viewBox="0 0 16 16" version="1.1" width="1em" height="1em" aria-hidden="true"><path d="M8 1.5c-2.363 0-4 1.69-4 3.75 0 .984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75 0 0 1-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456 0 0 0-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863 0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751 0 0 1-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304 0-2.06-1.637-3.75-4-3.75ZM5.75 12h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5ZM6 15.25a.75.75 0 0 1 .75-.75h2.5a.75.75 0 0 1 0 1.5h-2.5a.75.75 0 0 1-.75-.75Z"></path></svg>Tip</span><br></p><p>&nbsp;</p><p><span>الـ </span><code>T2 instances</code><span> معمولة عشان تشتغل على مستوى أداء أساسي وواطي للـ </span><code>CPU</code><span> (اسمه </span><strong><span>Baseline Performance</span></strong><span>). المستوى ده بيبقى نسبة قليلة من قوة الـ </span><code>CPU</code><span> كلها (مثلاً 20%).</span></p><ul><li><p><strong><span>تحويش الرصيد:</span></strong>
<span>لما الـ </span><code>instance</code><span> تكون شغالة بس استهلاكها للـ </span><code>CPU</code><span> أقل من المستوى الأساسي ده (يعني قاعدة فاضية)، هي بتقعد &quot;تحوّش&quot; رصيد اسمه </span><strong><code>CPU Credits</code></strong><span>. الرصيد ده بيتحوش بمعدل ثابت كل ساعة.</span></p></li><li><p><strong><span>صرف الرصيد:</span></strong>
<span>لما الـ </span><code>application</code><span> بتاعك يحتاج فجأة أداء أعلى من المستوى الأساسي (عشان جاله ضغط شغل مفاجئ)، الـ </span><code>instance</code><span> بتبدأ &quot;تصرف&quot; من الـ </span><code>CPU Credits</code><span> اللي حوشتها دي. الصرف ده بيخلي الـ </span><code>CPU</code><span> يشتغل بكامل قوته (ممكن يوصل 100%) لفترة مؤقتة. العملية دي اسمها </span><strong><code>burst</code></strong><span>.</span></p></li><li><p><strong><span>الرصيد يخلص:</span></strong>
<span>لو الضغط العالي ده فضل مكمل فترة طويلة والرصيد اللي متحوش خلص، أداء الـ </span><code>CPU</code><span> هينزل تاني للمستوى الأساسي الواطي بتاعه، وهيفضل كده لحد ما الـ </span><code>instance</code><span> ترجع تحوش رصيد من أول وجديد.</span></p></li></ul></div><p>&nbsp;</p><h3 id='تظبيط-البيئة-بتاعة-الـ-instance-بتاعتك'><strong><span>تظبيط البيئة بتاعة الـ Instance بتاعتك</span></strong></h3><p><span>إنك تقرر الـ </span><strong><span>EC2 instance</span></strong><span> بتاعتك هتعيش فين، ده مهم بالظبط زي ما بتختار مواصفات الأداء بتاعتها. في الحتة دي، في تلات تفاصيل أساسية لازم تظبطهم صح: الـ </span><strong><span>geographic region</span></strong><span>، والـ </span><strong><span>virtual private cloud (VPC)</span></strong><span>، والـ </span><strong><span>tenancy model</span></strong><span>.</span></p><h4 id='الـ-aws-regions'><strong><span>الـ AWS Regions</span></strong></h4><p><span>زي ما عرفنا قبل كده، السيرفرات بتاعت AWS موجودة في </span><code>data centers</code><span> في كل حتة في العالم، ومتنظمة على أساس الـ </span><strong><span>geographical region</span></strong><span>. في الغالب، أنت هتبقى عايز تشغل الـ </span><code>EC2 instance</code><span> بتاعتك في الـ </span><code>region</code><span> الأقرب في المكان لغالبية العملاء بتوعك. أو، لو شغال على داتا عليها قيود قانونية، يبقى تشغلها في منطقة قانونية تمشي مع الـ </span><code>compliance</code><span> اللي أنت محتاجه.</span></p><p><span>الـ </span><code>EC2 resources</code><span> مش هتعرف تديرها إلا وإنت &quot;موجود جوه&quot; الـ </span><code>region</code><span> بتاعتها. أنت بتحدد الـ </span><code>region</code><span> اللي أنت شغال فيها دلوقتي من الـ </span><code>console</code><span> عن طريق القايمة اللي بتنزل من فوق في الصفحة، أو عن طريق قيم إعدادات افتراضية في الـ </span><code>AWS CLI</code><span> أو الـ </span><code>SDK</code><span> بتاعك. ولو عايز تحدث الإعدادات بتاعت الـ CLI، بتشغل أمر </span><code>aws configure</code><span>.</span></p><p><strong><span>خلي بالك</span></strong><span> إن التكاليف وحتى وظايف الخدمات والمميزات ممكن تختلف من </span><code>region</code><span> للتانية. دايمًا فكرة كويسة إنك ترجع للـ </span><code>documentation</code><span> الرسمي آخر تحديث.</span></p><h4 id='الـ-vpcs'><strong><span>الـ VPCs</span></strong></h4><p><span>الـ </span><strong><span>Virtual private clouds (VPCs)</span></strong><span> دي أدوات  بتنظم بيها الشبكة بتاعتك على AWS، وهايلة عشان تنظم الـ </span><code>infrastructure</code><span> بتاعتك.</span></p><p><span>ولأن سهل أوي إنك تعزل الـ </span><code>instances</code><span> اللي في </span><code>VPC</code><span> معينة عن أي حاجة تانية شغالة عندك، ممكن تبقى عايز تعمل </span><code>VPC</code><span> جديدة لكل مشروع من مشاريعك، أو لكل مرحلة في المشروع. كمثال، ممكن تعمل </span><code>VPC</code><span> لمرحلة التطوير الأولية، وواحدة تانية للـ </span><code>beta testing</code><span>، وواحدة تالتة للـ </span><code>production</code><span> (بص على شكل 2.1).</span></p><p><span>(لسه هنخش فى network stack فى الفصل الرابع متقلقش لو مفمتهاش اعرف بس انه network component اللي بيدار فيه معظم resources بتاعك فى aws )</span></p><p><strong><span>شكل 2.1</span></strong></p><p><img src="/home/Taha/.config/Typora/typora-user-images/image-20250619064131255.png" referrerpolicy="no-referrer" alt="image-20250619064131255"><em><span>Infrastructure فيها كذا VPC عشان بيئة التطوير.</span></em></p><p><span>إنك تزود </span><code>VPC</code><span> بسيطة مفهاش </span><strong><span>NAT gateway</span></strong><span> (ودي بوابة بتخلي الـ instances اللي في شبكة خاصة توصل للنت) أو </span><strong><span>VPN access</span></strong><span> (عشان توصل شبكتك اللي على الأرض بشبكتك على AWS)، ده </span><strong><span>مش هيكلفك أي حاجة</span></strong><span>. هتتعلم أكتر بكتير عن كل ده في شابتر 4، &quot;Amazon Virtual Private Cloud&quot;.</span></p><h4 id='الـ-tenancy'><strong><span>الـ Tenancy </span></strong></h4><p><span>وإنت بتعمل </span><code>launch</code><span> لـ </span><code>EC2 instance</code><span>، هيبقى عندك فرصة تختار الـ </span><strong><code>tenancy model</code></strong><span>.</span></p><ul><li><p><strong><span>Shared Tenancy :</span></strong>
<span>ده الإعداد الافتراضي (</span><code>default</code><span>). في الحالة دي، الـ </span><code>instance</code><span> بتاعتك هتشتغل كـ </span><code>virtual machine</code><span> على </span><code>physical server</code><span> بيشغّل في نفس الوقت </span><code>instances</code><span> تانية. الـ </span><code>instances</code><span> التانية دي ممكن جدًا تكون ملك لعملاء AWS تانيين وبيشغلوها. طبعًا، احتمالية إن يحصل أي نوع من التفاعل الغير آمن بين الـ </span><code>instances</code><span> دي بعيدة جدًا.</span></p></li><li><p><strong><span>Dedicated Instance (Instance مخصصة):</span></strong>
<span>عشان توفي بمتطلبات قانونية معينة، ممكن الـ </span><code>instances</code><span> بتاعت شركتك تحتاج مستوى عزل زيادة. اختيار الـ </span><code>Dedicated Instance</code><span> بيضمن إن الـ </span><code>instance</code><span> بتاعتك هتشتغل على </span><code>physical server</code><span> مخصص ليك أنت بس. ده معناه إنها مش هتشارك السيرفر ده مع </span><code>resources</code><span> ملك لـ </span><code>account</code><span> بتاع عميل تاني.</span></p></li><li><p><strong><span>Dedicated Host (Host مخصص):</span></strong>
<span>الاختيار ده بيخليك فعلًا تحدد وتتحكم في الـ </span><code>physical server</code><span> نفسه اللي اتخصص ليك، عشان توفي بمتطلبات تراخيص أو قوانين صارمة أكتر.</span></p></li></ul><figure class='table-figure'><table><thead><tr><th style='text-align:left;' ><span>نقطة المقارنة</span></th><th style='text-align:left;' ><span>Dedicated Instance</span></th><th style='text-align:left;' ><span>Dedicated Host</span></th></tr></thead><tbody><tr><td style='text-align:left;' ><strong><span>إيه اللي بتاخده؟</span></strong></td><td style='text-align:left;' ><code>instance</code><span> شغالة على جهاز محدش بيشاركك فيه.</span></td><td style='text-align:left;' ><code>physical server</code><span> كامل ليك أنت بس.</span></td></tr><tr><td style='text-align:left;' ><strong><span>التحكم؟</span></strong></td><td style='text-align:left;' ><span>AWS بتختارلك الجهاز، وممكن يتغير.</span></td><td style='text-align:left;' ><span>أنت بتختار وتتحكم في الجهاز، وهو ثابت.</span></td></tr><tr><td style='text-align:left;' ><strong><span>الاستخدام الأساسي؟</span></strong></td><td style='text-align:left;' ><span>عشان الـ </span><code>compliance</code><span> والأمان بس.</span></td><td style='text-align:left;' ><span>عشان الـ </span><code>compliance</code><span> </span><strong><span>وإدارة التراخيص (BYOL)</span></strong><span>.</span></td></tr><tr><td style='text-align:left;' ><strong><span>الفلوس؟</span></strong></td><td style='text-align:left;' ><span>أغلى من الـ Shared.</span></td><td style='text-align:left;' ><span>أغلى من الـ Dedicated Instance.</span></td></tr></tbody></table></figure><p><span>طبعًا، الـ </span><code>dedicated instances</code><span> والـ </span><code>dedicated hosts</code><span> هيكلفوك أكتر من الـ </span><code>instances</code><span> اللي بتستخدم </span><code>shared tenancy</code><span>.</span></p><p><span>تمرين 2.1 هيوريك خطوة بخطوة إزاي تعمل </span><code>launch</code><span> لـ </span><code>EC2 Linux instance</code><span> بسيطة.</span></p><p><img src="/home/Taha/.config/Typora/typora-user-images/image-20250619065144483.png" referrerpolicy="no-referrer" alt="image-20250619065144483"></p><p>&nbsp;</p><p>&nbsp;</p><p><span>اول حاجة عيزين ننشاء private key و public key عشان ssh connection خلي باللك فى اكثر من نوع  algorithm وممكن اعمل موضوع على ايه افضل الخورزيميات ولكن خلينا فى الموضوع rsa_bits دا طول المفتاح ودا كافي </span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="terraform"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="terraform"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 17.0221px; left: 7.6302px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">resource</span> <span class="cm-string">"tls_private_key"</span> <span class="cm-string">"my_ssh_key"</span> {</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">algorithm</span> <span class="cm-operator">=</span> <span class="cm-string">"RSA"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">rsa_bits</span> &nbsp;<span class="cm-operator">=</span> <span class="cm-number">4096</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 90px;"></div><div class="CodeMirror-gutters" style="display: none; height: 90px;"></div></div></div></pre><p><span>انت دلوقتي انشاءت مفتاحين واحد private و واحد public انا محتاج private عشان اعمل access من على جهاز هو دلوقتي مش موجود على الجهاز terraform انشاءه ولسه محفوظوش عشان احفظة </span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="terraform"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="terraform"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 17.0221px; left: 7.6302px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">resource</span> <span class="cm-string">"local_file"</span> <span class="cm-string">"ssh_key_file"</span> {</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">content</span> &nbsp;<span class="cm-operator">=</span> <span class="cm-variable">tls_private_key</span><span class="cm-operator">.</span><span class="cm-property">my_ssh_key</span><span class="cm-operator">.</span><span class="cm-property">private_key_pem</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">filename</span> <span class="cm-operator">=</span> <span class="cm-string">"my-ec2-key.pem"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">file_permission</span> <span class="cm-operator">=</span> <span class="cm-string">"0400"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 112px;"></div><div class="CodeMirror-gutters" style="display: none; height: 112px;"></div></div></div></pre><p><span>دلوقتي هستخدام </span></p><p><strong><span>3.نقصلك ترفع بس public key على aws وعن طر</span></strong><span>يق aws_key_pair بتقدر ترفعه خد باللك انا هنا مش بستخدام KMS</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="terraform"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="terraform"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 17.0241px; left: 7.6302px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">resource</span> <span class="cm-string">"aws_key_pair"</span> <span class="cm-string">"generated_key"</span> {</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">key_name</span> &nbsp; <span class="cm-operator">=</span> <span class="cm-string">"my-ec2-key"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">public_key</span> <span class="cm-operator">=</span> <span class="cm-variable">tls_private_key</span><span class="cm-operator">.</span><span class="cm-property">my_ssh_key</span><span class="cm-operator">.</span><span class="cm-property">public_key_openssh</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 90px;"></div><div class="CodeMirror-gutters" style="display: none; height: 90px;"></div></div></div></pre><p><span>هتنشاء security group بتسمح بـ اتصال ssh عن طريق port 22</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="terraform"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="terraform"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 17.0221px; left: 7.6302px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">resource</span> <span class="cm-string">"aws_security_group"</span> <span class="cm-string">"allow_ssh"</span> {</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">name</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-operator">=</span> <span class="cm-string">"allow-ssh-sg"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">description</span> <span class="cm-operator">=</span> <span class="cm-string">"Allow SSH inbound traffic"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">ingress</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">from_port</span> &nbsp; <span class="cm-operator">=</span> <span class="cm-number">22</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">to_port</span> &nbsp; &nbsp; <span class="cm-operator">=</span> <span class="cm-number">22</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">protocol</span> &nbsp; &nbsp;<span class="cm-operator">=</span> <span class="cm-string">"tcp"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">cidr_blocks</span> <span class="cm-operator">=</span> [<span class="cm-string">"0.0.0.0/0"</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 291px;"></div><div class="CodeMirror-gutters" style="display: none; height: 291px;"></div></div></div></pre><h3 id='ممكن-توفر-على-نفسك-وتروح-تجيب-id-بتاع-ami-بس-خليك-فاكر-دي-مش-احسن-حاجة-لان-ami--بيتغير-region-لـregion-ثانية-فأن-بستخدام-data-عشان-منخلله-بقدر-اجيب-اي-حاجة-متوفر-على-aws-بس-خلي-بالك-readonly-انا-كد-عملت-filter-اننا-عيز-ami-مملوكة-لـamazon-وتكون-احدث-اصدار-وده-amzn2-ami-hvm--x8664-gp2-معناها-عيز-ami-تكون-x64-دي-المعمارية-ويكون-نوع-root-volume--اللي-هيتحط-على-os-يكون-general-purpose-ssd'><span>ممكن توفر على نفسك وتروح تجيب id بتاع ami بس خليك فاكر دي مش احسن حاجة لان ami  بيتغير region لـregion ثانية فأن بستخدام data عشان منخلله بقدر اجيب اي حاجة متوفر على aws بس خلي بالك readonly انا كد عملت filter اننا عيز ami مملوكة لـamazon وتكون احدث اصدار وده amzn2-ami-hvm-*-x86_64-gp2 معناها عيز ami تكون x64 دي المعمارية ويكون نوع root volume  اللي هيتحط على os يكون General Purpose SSD</span></h3><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="terraform"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="terraform"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 17.0241px; left: 7.6302px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data</span> <span class="cm-string">"aws_ami"</span> <span class="cm-string">"amazon_linux"</span> {</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">most_recent</span> <span class="cm-operator">=</span> <span class="cm-keyword">true</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">owners</span> &nbsp; &nbsp; &nbsp;<span class="cm-operator">=</span> [<span class="cm-string">"amazon"</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">filter</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">name</span> &nbsp; <span class="cm-operator">=</span> <span class="cm-string">"name"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">values</span> <span class="cm-operator">=</span> [<span class="cm-string">"amzn2-ami-hvm-*-x86_64-gp2"</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 179px;"></div><div class="CodeMirror-gutters" style="display: none; height: 179px;"></div></div></div></pre><hr /><h3 id='القطعة-الرابعة-الـ-instance-نفسها-تجميع-كل-اللي-فات'><strong><span>القطعة الرابعة: الـ Instance نفسها (تجميع كل اللي فات)</span></strong></h3><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="terraform"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="terraform"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 17.0241px; left: 7.6302px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">resource</span> <span class="cm-string">"aws_instance"</span> <span class="cm-string">"my_ec2"</span> {</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">ami</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-operator">=</span> <span class="cm-variable">data</span><span class="cm-operator">.</span><span class="cm-property">aws_ami</span><span class="cm-operator">.</span><span class="cm-property">amazon_linux</span><span class="cm-operator">.</span><span class="cm-property">id</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">instance_type</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-operator">=</span> <span class="cm-string">"t2.micro"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">key_name</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-operator">=</span> <span class="cm-variable">aws_key_pair</span><span class="cm-operator">.</span><span class="cm-property">generated_key</span><span class="cm-operator">.</span><span class="cm-property">key_name</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">vpc_security_group_ids</span> <span class="cm-operator">=</span> [<span class="cm-variable">aws_security_group</span><span class="cm-operator">.</span><span class="cm-property">allow_ssh</span><span class="cm-operator">.</span><span class="cm-property">id</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 157px;"></div><div class="CodeMirror-gutters" style="display: none; height: 157px;"></div></div></div></pre><p><span>هنا بقى بتجمع كل حاجة ami بتحط id اللي انت اختارته و instance_type خلينا &quot;t2.micro&quot; لانه ارخص حاجة key_name الللي اختارناها  و vpc_security_group_ids خدها قاعد اي حاجة جمع بتاخد list واي حاجة جمع مثلا زي data اللي reference  بتطلع ouput ويكون اسمه جمع تتطلع list زي اللي فاتت كده aws_ami بتطله ami واحده طب لو انا استخدمت  aws_ami_ids هتطلع list</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="terraform"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="terraform"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 17.0241px; left: 7.6302px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">output</span> <span class="cm-string">"instance_public_ip"</span> {</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">value</span> <span class="cm-operator">=</span> <span class="cm-variable">aws_instance</span><span class="cm-operator">.</span><span class="cm-property">my_ec2</span><span class="cm-operator">.</span><span class="cm-property">public_ip</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">output</span> <span class="cm-string">"ssh_command"</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">value</span> <span class="cm-operator">=</span> <span class="cm-string">"ssh -i ${local_file.ssh_key_file.filename} ec2-user@${aws_instance.my_ec2.public_ip}"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 202px;"></div><div class="CodeMirror-gutters" style="display: none; height: 202px;"></div></div></div></pre><p><span>هنا بتطلع ssh comand عشان تعمل access مباشرة على  ec2 خلي باللك كل ده تم  فى default vpc وDefault Subnet </span></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><h3 id='تمرين-22-شوف-الـ-capacity-الفاضية-في-instance-شغالة-وغيّر-النوع-بتاعها'><strong><span>تمرين 2.2: شوف الـ Capacity الفاضية في Instance شغالة وغيّر النوع بتاعها</span></strong></h3><h4 id='الخطوة-الأولى-المراقبة-الـ-monitoring'><strong><span>الخطوة الأولى: المراقبة (الـ Monitoring)</span></strong></h4><blockquote><p><strong><span>1. وإنت مشغّل الـ instance، افتح الـ Instances Dashboard في الـ EC2 console. اعمل select للـ instance اللي تهمك ودوس على تاب الـ Monitoring اللي في نص الشاشة اللي تحت. المكان ده كويس عشان تشوف الـ instance بتاعتك استهلكت قد إيه من قوة الـ compute والـ network في الساعات أو الأسابيع اللي فاتت.</span></strong></p></blockquote><ul><li><p><strong><span>شرح الخطوة دي:</span></strong>
<span>المكان ده عامل زي </span><strong><span>تابلوه العربية</span></strong><span> بتاعك. بيوريك الـ </span><code>instance</code><span> بتاعتك شغالة إزاي وبصحة كويسة ولا لأ.</span>
<span>هتلاقي فيه رسومات بيانية (graphs) لأهم حاجة:</span></p><ul><li><p><strong><span>CPU Utilization:</span></strong><span> ده أهم واحد. بيوريك الـ </span><code>CPU</code><span> مضغوط بنسبة كام في المية. لو لقيته دايمًا فوق الـ 80% أو 90%، يبقى الـ </span><code>instance</code><span> دي </span><strong><span>بتستنجد</span></strong><span> وبتقولك أنا مش قادرة.</span></p></li><li><p><strong><span>Network In/Out:</span></strong><span> بيوريك حجم الداتا اللي داخلة وطالعة من الـ </span><code>instance</code><span>.</span></p></li></ul></li></ul><h4 id='الخطوة-التانية-تغيير-نوع-الـ-instance'><strong><span>الخطوة التانية: تغيير نوع الـ Instance</span></strong></h4><blockquote><p><strong><span>2. دلوقتي، تخيل إن الـ </span><code>instance</code><span> بتاعتك دي خلاص جابت آخرها ومضغوطة على الآخر، وغير الـ </span><code>instance type</code><span> بتاعها.</span></strong></p></blockquote><ul><li><p><strong><span>شرح الخطوة دي:</span></strong>
<span>لو لقيت من الـ </span><code>Monitoring</code><span> إن الـ </span><code>instance</code><span> بتاعتك تعبانة على طول، يبقى لازم تكبّرها وتديها </span><code>hardware</code><span> أقوى. هتعمل إيه عشان تغيرها؟</span></p><ol start='' ><li><p><span>أول حاجة لازم </span><strong><span>توقف الـ </span><code>instance</code></strong><span> دي (</span><code>Actions -&gt; Instance State -&gt; Stop instance</code><span>). مش هينفع تغير نوعها وهي شغالة.</span></p></li><li><p><span>بعد ما تقف، هتدوس على </span><strong><code>Actions -&gt; Instance settings -&gt; Change instance type</code></strong><span>.</span></p></li><li><p><span>هتفتحلك قايمة تختار منها نوع أكبر وأقوى (مثلاً، هتغيرها من </span><code>t2.micro</code><span> لـ </span><code>t2.medium</code><span>).</span></p></li><li><p><span>بعدين هتشغل الـ </span><code>instance</code><span> تاني (</span><code>Actions -&gt; Instance State -&gt; Start instance</code><span>).</span></p></li></ol></li></ul><p><span>بس كده! في دقيقة الـ </span><code>instance</code><span> بتاعتك هتقوم تاني بالـ </span><code>hardware</code><span> الجديد الأقوى بتاعها، بنفس الهارد ديسك وبنفس الداتا وكل حاجة.</span></p><hr /><h3 id='الزتونة-إيه-لازمة-التمرين-ده'><strong><span>الزتونة: إيه لازمة التمرين ده؟</span></strong></h3><p><span>التمرين ده بيعلمك حاجة مهمة جدًا في شغل الـ Cloud اسمها </span><strong><span>Right-Sizing</span></strong><span> (يعني اختيار الحجم الصح).</span></p><p><span>الفكرة إنك متدفعش فلوس في </span><code>instance</code><span> قوية أوي وهي قاعدة فاضية معظم الوقت، وفي نفس الوقت متخنقش الـ </span><code>application</code><span> بتاعك بـ </span><code>instance</code><span> ضعيفة مش قادرة عليه.</span></p><p><strong><span>الصح إيه؟</span></strong><span> إنك تراقب الأداء، ولو لقيت الـ </span><code>instance</code><span> تعبانة ومضغوطة، </span><strong><span>تكبّرها (Scale Up)</span></strong><span>. ولو لقيتها فاضية ومرتاحة زيادة عن اللزوم، </span><strong><span>تصغّرها (Scale Down)</span></strong><span> عشان توفر فلوس.</span></p><h3 id='طب-وإزاي-بنعمل-الكلام-ده-في-terraform'><strong><span>طب وإزاي بنعمل الكلام ده في Terraform؟</span></strong></h3><p><span>دي بقى أحلى حتة. الموضوع بيبقى تافه جدًا.</span>
<span>لو الكود بتاعك كان كده:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="terraform"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="terraform"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 17.0241px; left: 7.6302px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">resource</span> <span class="cm-string">"aws_instance"</span> <span class="cm-string">"my_ec2"</span> {</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">ami</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-operator">=</span> <span class="cm-string">"ami-xxxxxxxx"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">instance_type</span> <span class="cm-operator">=</span> <span class="cm-string">"t2.micro"</span> &nbsp;<span class="cm-comment"># &lt;- الحجم القديم</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 90px;"></div><div class="CodeMirror-gutters" style="display: none; height: 90px;"></div></div></div></pre><p><span>عشان تكبّرها، كل اللي هتعمله إنك هتغير السطر ده بس:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="terraform"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="terraform"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 17.0241px; left: 7.6302px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">resource</span> <span class="cm-string">"aws_instance"</span> <span class="cm-string">"my_ec2"</span> {</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">ami</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-operator">=</span> <span class="cm-string">"ami-xxxxxxxx"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">instance_type</span> <span class="cm-operator">=</span> <span class="cm-string">"t2.medium"</span> <span class="cm-comment"># &lt;- الحجم الجديد</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 90px;"></div><div class="CodeMirror-gutters" style="display: none; height: 90px;"></div></div></div></pre><p><span>لما تشغل </span><code>terraform apply</code><span>، تيرافورم هيفهم لوحده إنه محتاج يوقف الـ </span><code>instance</code><span>، ويغير النوع، ويشغلها تاني. هيعمل كل ده أوتوماتيك من غير ما تلمس الـ Console.</span></p><p>&nbsp;</p><p>&nbsp;</p><h2 id='تظبيط-سلوك-الـ-instance-configuring-instance-behavior'><strong><span>تظبيط سلوك الـ Instance (Configuring Instance Behavior)</span></strong></h2><p><span>أنت تقدر تقول لـ EC2 ينفذ أوامر على الـ </span><code>instance</code><span> بتاعتك وهي بتقوم، وده عن طريق إنك تحدد حاجة اسمها </span><strong><code>user data</code></strong><span> في إعدادات الـ </span><code>instance</code><span> بتاعتك (والعملية دي أحيانًا بنسميها </span><strong><span>bootstrapping</span></strong><span>).</span></p><p><span>سواء بتحدد الداتا دي وإنت بتعمل الـ </span><code>instance</code><span> من الـ </span><code>console</code><span> أو بتستخدم قيمة </span><code>--user-data</code><span> في الـ AWS CLI، أنت تقدر تخلي </span><code>script</code><span> معين يشتغل ويجهز الـ </span><code>instance</code><span> بتاعتك لأي حالة أنت عايزها.</span></p><p><span>الـ </span><code>user data</code><span> ده ممكن يكون كام أمر بسيط عشان تثبت </span><code>web server</code><span> وتجهز الموقع بتاعه، أو ممكن يكون </span><code>script</code><span> معقد بيظبط الـ </span><code>instance</code><span> عشان تبقى جزء من منصة كبيرة زي Puppet Enterprise.</span></p><h3 id='الـ-placement-groups'><strong><span>الـ Placement Groups</span></strong></h3><p><span>بشكل افتراضي، AWS بتحاول توزع الـ </span><code>instances</code><span> بتاعتك على الـ </span><code>infrastructure</code><span> بتاعتها عشان تديك أحسن أداء لمعظم حالات الاستخدام. بس ممكن الشغل بتاعك يبقى محتاج ترتيب مختلف. الـ </span><strong><code>Placement Groups</code></strong><span> بتديلك القوة إنك تحدد ترتيبات غير عادية عشان تناسب احتياجاتك. حاليًا، في تلات أنواع منهم:</span></p><ul><li><p><strong><span>Cluster groups:</span></strong>
<span>دي زي ما تكون بتقول لـ AWS: </span><strong><span>&quot;حطلي كل الـ instances دي جنب بعض في نفس الأوضة ولزقهم في بعض&quot;</span></strong><span>. كل </span><code>instance</code><span> في المجموعة دي بتشتغل في نفس الـ </span><code>availability zone</code><span> وقريبة جدًا من التانية في المكان. ده بيديلك </span><code>low-latency network</code><span> (يعني سرعة اتصال عالية جدًا بينهم) ومفيد في حاجات زي الـ </span><code>high-performance computing (HPC)</code><span>.</span></p></li><li><p><span>مثال :  بناء بيئة </span><code>High-Performance Computing (HPC)</code><span> سريعة جدًا، كل السيرفرات فيها بتكلم بعض بأقل </span><code>latency</code><span> ممكن</span></p></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="terraform" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="terraform"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 17.0241px; left: 7.6302px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">resource</span> <span class="cm-string">"aws_vpc"</span> <span class="cm-string">"hpc_vpc"</span> {</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">cidr_block</span> <span class="cm-operator">=</span> <span class="cm-string">"10.10.0.0/16"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">resource</span> <span class="cm-string">"aws_subnet"</span> <span class="cm-string">"hpc_subnet"</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">vpc_id</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-operator">=</span> <span class="cm-variable">aws_vpc</span><span class="cm-operator">.</span><span class="cm-property">hpc_vpc</span><span class="cm-operator">.</span><span class="cm-property">id</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">cidr_block</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-operator">=</span> <span class="cm-string">"10.10.1.0/24"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">availability_zone</span> <span class="cm-operator">=</span> <span class="cm-string">"us-west-2a"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># بكده هنخليهم جمب بعض قدر الامكان</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">resource</span> <span class="cm-string">"aws_security_group"</span> <span class="cm-string">"hpc_sg"</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">name</span> &nbsp; <span class="cm-operator">=</span> <span class="cm-string">"hpc-sg"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">vpc_id</span> <span class="cm-operator">=</span> <span class="cm-variable">aws_vpc</span><span class="cm-operator">.</span><span class="cm-property">hpc_vpc</span><span class="cm-operator">.</span><span class="cm-property">id</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">ingress</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">from_port</span> <span class="cm-operator">=</span> <span class="cm-number">0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">to_port</span> &nbsp; <span class="cm-operator">=</span> <span class="cm-number">0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">protocol</span> &nbsp;<span class="cm-operator">=</span> <span class="cm-string">"-1"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">self</span> &nbsp; &nbsp; &nbsp;<span class="cm-operator">=</span> <span class="cm-keyword">true</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">egress</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">from_port</span> &nbsp; <span class="cm-operator">=</span> <span class="cm-number">0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">to_port</span> &nbsp; &nbsp; <span class="cm-operator">=</span> <span class="cm-number">0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">protocol</span> &nbsp; &nbsp;<span class="cm-operator">=</span> <span class="cm-string">"-1"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">cidr_blocks</span> <span class="cm-operator">=</span> [<span class="cm-string">"0.0.0.0/0"</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">resource</span> <span class="cm-string">"aws_placement_group"</span> <span class="cm-string">"hpc_cluster_pg"</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">name</span> &nbsp; &nbsp; <span class="cm-operator">=</span> <span class="cm-string">"my-hpc-cluster"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">strategy</span> <span class="cm-operator">=</span> <span class="cm-string">"cluster"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">resource</span> <span class="cm-string">"aws_instance"</span> <span class="cm-string">"hpc_node_1"</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">ami</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-operator">=</span> <span class="cm-string">"ami-0c55b159cbfafe1f0"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">instance_type</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-operator">=</span> <span class="cm-string">"c5n.large"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">subnet_id</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-operator">=</span> <span class="cm-variable">aws_subnet</span><span class="cm-operator">.</span><span class="cm-property">hpc_subnet</span><span class="cm-operator">.</span><span class="cm-property">id</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">vpc_security_group_ids</span> <span class="cm-operator">=</span> [<span class="cm-variable">aws_security_group</span><span class="cm-operator">.</span><span class="cm-property">hpc_sg</span><span class="cm-operator">.</span><span class="cm-property">id</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">placement_group</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-operator">=</span> <span class="cm-variable">aws_placement_group</span><span class="cm-operator">.</span><span class="cm-property">hpc_cluster_pg</span><span class="cm-operator">.</span><span class="cm-property">id</span> <span class="cm-comment"># &lt;==</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">resource</span> <span class="cm-string">"aws_instance"</span> <span class="cm-string">"hpc_node_2"</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">ami</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-operator">=</span> <span class="cm-string">"ami-0c55b159cbfafe1f0"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">instance_type</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-operator">=</span> <span class="cm-string">"c5n.large"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">subnet_id</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-operator">=</span> <span class="cm-variable">aws_subnet</span><span class="cm-operator">.</span><span class="cm-property">hpc_subnet</span><span class="cm-operator">.</span><span class="cm-property">id</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">vpc_security_group_ids</span> <span class="cm-operator">=</span> [<span class="cm-variable">aws_security_group</span><span class="cm-operator">.</span><span class="cm-property">hpc_sg</span><span class="cm-operator">.</span><span class="cm-property">id</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">placement_group</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-operator">=</span> <span class="cm-variable">aws_placement_group</span><span class="cm-operator">.</span><span class="cm-property">hpc_cluster_pg</span><span class="cm-operator">.</span><span class="cm-property">id</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 1165px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1165px;"></div></div></div></pre><ul><li><p><strong><span>Spread groups:</span></strong>
<span>دي العكس تمامًا. بتقول لـ AWS: </span><strong><span>&quot;ابعدلي الـ instances دي عن بعض على قد ما تقدر. حط كل واحدة على جهاز (</span><code>rack</code><span>) مختلف تمامًا&quot;</span></strong><span>. ده بيقلل خطر إن عطل واحد في جهاز يوقع كذا </span><code>instance</code><span> في نفس الوقت. ده مهم أوي لما تكون مشغل حاجات حساسة مش بتستحمل إن كذا حاجة تقع مع بعض. (لو ليك في VMware، دي شبه الـ DRS).</span></p></li><li><p><span>مثال: بناء </span><code>web application</code><span> عنده </span><code>high availability</code><span>. لو جهاز (</span><code>rack</code><span>) وقع، </span><code>instance</code><span> واحدة بس هي اللي تتأثر، مش الاتنين.</span></p></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="terraform" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="terraform"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 17.0221px; left: 7.6302px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">### مثال لتوضيح Spread Placement Group داخل نفس الـ AZ ###</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 1. تعريف الـ Provider</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">provider</span> <span class="cm-string">"aws"</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">region</span> <span class="cm-operator">=</span> <span class="cm-string">"us-west-2"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">resource</span> <span class="cm-string">"aws_vpc"</span> <span class="cm-string">"spread_vpc"</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">cidr_block</span> <span class="cm-operator">=</span> <span class="cm-string">"10.20.0.0/16"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">tags</span> &nbsp; &nbsp; &nbsp; <span class="cm-operator">=</span> { <span class="cm-tag">Name</span> <span class="cm-operator">=</span> <span class="cm-string">"spread-vpc"</span> }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">resource</span> <span class="cm-string">"aws_subnet"</span> <span class="cm-string">"spread_subnet_a"</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">vpc_id</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-operator">=</span> <span class="cm-variable">aws_vpc</span><span class="cm-operator">.</span><span class="cm-property">spread_vpc</span><span class="cm-operator">.</span><span class="cm-property">id</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">cidr_block</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-operator">=</span> <span class="cm-string">"10.20.1.0/24"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">availability_zone</span> <span class="cm-operator">=</span> <span class="cm-string">"us-west-2a"</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">tags</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-operator">=</span> { <span class="cm-tag">Name</span> <span class="cm-operator">=</span> <span class="cm-string">"spread-subnet-a"</span> }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">resource</span> <span class="cm-string">"aws_security_group"</span> <span class="cm-string">"spread_sg"</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">name</span> &nbsp; <span class="cm-operator">=</span> <span class="cm-string">"spread-sg"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">vpc_id</span> <span class="cm-operator">=</span> <span class="cm-variable">aws_vpc</span><span class="cm-operator">.</span><span class="cm-property">spread_vpc</span><span class="cm-operator">.</span><span class="cm-property">id</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">ingress</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">from_port</span> &nbsp; <span class="cm-operator">=</span> <span class="cm-number">80</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">to_port</span> &nbsp; &nbsp; <span class="cm-operator">=</span> <span class="cm-number">80</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">protocol</span> &nbsp; &nbsp;<span class="cm-operator">=</span> <span class="cm-string">"tcp"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">cidr_blocks</span> <span class="cm-operator">=</span> [<span class="cm-string">"0.0.0.0/0"</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">egress</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">from_port</span> &nbsp; <span class="cm-operator">=</span> <span class="cm-number">0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">to_port</span> &nbsp; &nbsp; <span class="cm-operator">=</span> <span class="cm-number">0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">protocol</span> &nbsp; &nbsp;<span class="cm-operator">=</span> <span class="cm-string">"-1"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">cidr_blocks</span> <span class="cm-operator">=</span> [<span class="cm-string">"0.0.0.0/0"</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">resource</span> <span class="cm-string">"aws_placement_group"</span> <span class="cm-string">"app_spread_pg"</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">name</span> &nbsp; &nbsp; <span class="cm-operator">=</span> <span class="cm-string">"my-critical-app-spread"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">strategy</span> <span class="cm-operator">=</span> <span class="cm-string">"spread"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data</span> <span class="cm-string">"aws_ami"</span> <span class="cm-string">"amazon_linux_2"</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">most_recent</span> <span class="cm-operator">=</span> <span class="cm-keyword">true</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">owners</span> &nbsp; &nbsp; &nbsp;<span class="cm-operator">=</span> [<span class="cm-string">"amazon"</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">filter</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">name</span> &nbsp; <span class="cm-operator">=</span> <span class="cm-string">"name"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">values</span> <span class="cm-operator">=</span> [<span class="cm-string">"amzn2-ami-hvm-*-x86_64-gp2"</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">resource</span> <span class="cm-string">"aws_instance"</span> <span class="cm-string">"web_server_1"</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">ami</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-operator">=</span> <span class="cm-variable">data</span><span class="cm-operator">.</span><span class="cm-property">aws_ami</span><span class="cm-operator">.</span><span class="cm-property">amazon_linux_2</span><span class="cm-operator">.</span><span class="cm-property">id</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">instance_type</span> <span class="cm-operator">=</span> <span class="cm-string">"t3.medium"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">subnet_id</span> &nbsp; &nbsp; <span class="cm-operator">=</span> <span class="cm-variable">aws_subnet</span><span class="cm-operator">.</span><span class="cm-property">spread_subnet_a</span><span class="cm-operator">.</span><span class="cm-property">id</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">vpc_security_group_ids</span> <span class="cm-operator">=</span> [<span class="cm-variable">aws_security_group</span><span class="cm-operator">.</span><span class="cm-property">spread_sg</span><span class="cm-operator">.</span><span class="cm-property">id</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">placement_group</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-operator">=</span> <span class="cm-variable">aws_placement_group</span><span class="cm-operator">.</span><span class="cm-property">app_spread_pg</span><span class="cm-operator">.</span><span class="cm-property">id</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">tags</span> <span class="cm-operator">=</span> { <span class="cm-tag">Name</span> <span class="cm-operator">=</span> <span class="cm-string">"web-server-1 (in spread group)"</span> }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">resource</span> <span class="cm-string">"aws_instance"</span> <span class="cm-string">"web_server_2"</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">ami</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-operator">=</span> <span class="cm-variable">data</span><span class="cm-operator">.</span><span class="cm-property">aws_ami</span><span class="cm-operator">.</span><span class="cm-property">amazon_linux_2</span><span class="cm-operator">.</span><span class="cm-property">id</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">instance_type</span> <span class="cm-operator">=</span> <span class="cm-string">"t3.medium"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">subnet_id</span> &nbsp; &nbsp; <span class="cm-operator">=</span> <span class="cm-variable">aws_subnet</span><span class="cm-operator">.</span><span class="cm-property">spread_subnet_a</span><span class="cm-operator">.</span><span class="cm-property">id</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">vpc_security_group_ids</span> <span class="cm-operator">=</span> [<span class="cm-variable">aws_security_group</span><span class="cm-operator">.</span><span class="cm-property">spread_sg</span><span class="cm-operator">.</span><span class="cm-property">id</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">placement_group</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-operator">=</span> <span class="cm-variable">aws_placement_group</span><span class="cm-operator">.</span><span class="cm-property">app_spread_pg</span><span class="cm-operator">.</span><span class="cm-property">id</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">tags</span> <span class="cm-operator">=</span> { <span class="cm-tag">Name</span> <span class="cm-operator">=</span> <span class="cm-string">"web-server-2 (in spread group)"</span> }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 1814px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1814px;"></div></div></div></pre><p>&nbsp;</p><ul><li><p><strong><span>Partition groups:</span></strong>
<span>دي حل وسط بين الاتنين اللي فاتوا. تخيلها زي ما تكون بتقول لـ AWS: </span><strong><span>&quot;أنا عندي مجموعات (partitions). كل مجموعة حطها على جهاز لوحدها، بس الـ instances اللي جوه نفس المجموعة ممكن يبقوا جنب بعض&quot;</span></strong><span>. يعني الـ </span><code>instances</code><span> اللي في </span><code>partition</code><span> واحدة بيبقوا معزولين عن الـ </span><code>instances</code><span> اللي في أي </span><code>partition</code><span> تانية. ده مختلف عن الـ </span><code>spread groups</code><span> اللي فيها مفيش أي اتنين </span><code>instances</code><span> ممكن يبقوا على نفس الجهاز أبدًا.</span></p></li><li><p><span>مثال: بناء </span><code>cluster</code><span> لـ </span><code>database</code><span> زي Cassandra أو Kafka. عايزين نضمن إن كل نسخة من الداتا (</span><code>replica</code><span>) موجودة على جهاز منفصل تمامًا عن النسخ التانية.</span></p></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="terraform" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="terraform"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 17.0241px; left: 7.6302px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">resource</span> <span class="cm-string">"aws_vpc"</span> <span class="cm-string">"partition_vpc"</span> {</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">cidr_block</span> <span class="cm-operator">=</span> <span class="cm-string">"10.30.0.0/16"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">tags</span> <span class="cm-operator">=</span> { <span class="cm-tag">Name</span> <span class="cm-operator">=</span> <span class="cm-string">"partition-vpc"</span> }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 2. بنعمل Subnet واحدة (ممكن أكتر لو عايزين)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">resource</span> <span class="cm-string">"aws_subnet"</span> <span class="cm-string">"partition_subnet"</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">vpc_id</span> &nbsp; &nbsp; <span class="cm-operator">=</span> <span class="cm-variable">aws_vpc</span><span class="cm-operator">.</span><span class="cm-property">partition_vpc</span><span class="cm-operator">.</span><span class="cm-property">id</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">cidr_block</span> <span class="cm-operator">=</span> <span class="cm-string">"10.30.1.0/24"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">tags</span> <span class="cm-operator">=</span> { <span class="cm-tag">Name</span> <span class="cm-operator">=</span> <span class="cm-string">"partition-subnet"</span> }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">resource</span> <span class="cm-string">"aws_security_group"</span> <span class="cm-string">"partition_sg"</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">name</span> &nbsp; <span class="cm-operator">=</span> <span class="cm-string">"partition-sg"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">vpc_id</span> <span class="cm-operator">=</span> <span class="cm-variable">aws_vpc</span><span class="cm-operator">.</span><span class="cm-property">partition_vpc</span><span class="cm-operator">.</span><span class="cm-property">id</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">ingress</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">from_port</span> <span class="cm-operator">=</span> <span class="cm-number">0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">to_port</span> &nbsp; <span class="cm-operator">=</span> <span class="cm-number">0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">protocol</span> &nbsp;<span class="cm-operator">=</span> <span class="cm-string">"-1"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">self</span> &nbsp; &nbsp; &nbsp;<span class="cm-operator">=</span> <span class="cm-keyword">true</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">egress</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">from_port</span> &nbsp; <span class="cm-operator">=</span> <span class="cm-number">0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">to_port</span> &nbsp; &nbsp; <span class="cm-operator">=</span> <span class="cm-number">0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">protocol</span> &nbsp; &nbsp;<span class="cm-operator">=</span> <span class="cm-string">"-1"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">cidr_blocks</span> <span class="cm-operator">=</span> [<span class="cm-string">"0.0.0.0/0"</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">resource</span> <span class="cm-string">"aws_placement_group"</span> <span class="cm-string">"kafka_partition_pg"</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">name</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-operator">=</span> <span class="cm-string">"my-kafka-partitions"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">strategy</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-operator">=</span> <span class="cm-string">"partition"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">partition_count</span> &nbsp;<span class="cm-operator">=</span> <span class="cm-number">3</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">resource</span> <span class="cm-string">"aws_instance"</span> <span class="cm-string">"kafka_node_1"</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">ami</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-operator">=</span> <span class="cm-string">"ami-0c55b159cbfafe1f0"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">instance_type</span> <span class="cm-operator">=</span> <span class="cm-string">"i3.large"</span> &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">subnet_id</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-operator">=</span> <span class="cm-variable">aws_subnet</span><span class="cm-operator">.</span><span class="cm-property">partition_subnet</span><span class="cm-operator">.</span><span class="cm-property">id</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">vpc_security_group_ids</span> <span class="cm-operator">=</span> [<span class="cm-variable">aws_security_group</span><span class="cm-operator">.</span><span class="cm-property">partition_sg</span><span class="cm-operator">.</span><span class="cm-property">id</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">placement_group</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-operator">=</span> <span class="cm-variable">aws_placement_group</span><span class="cm-operator">.</span><span class="cm-property">kafka_partition_pg</span><span class="cm-operator">.</span><span class="cm-property">id</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># partition &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  = 1 </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># تقدر تحدد بنفسك او هو هيوزع بنفسه </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 1,2,3,1,2,3,1,2,3</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># هيفضل ماشي كده</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">tags</span> <span class="cm-operator">=</span> { <span class="cm-tag">Name</span> <span class="cm-operator">=</span> <span class="cm-string">"kafka-node-1"</span> }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">resource</span> <span class="cm-string">"aws_instance"</span> <span class="cm-string">"kafka_node_2"</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">ami</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-operator">=</span> <span class="cm-string">"ami-0c55b159cbfafe1f0"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">instance_type</span> <span class="cm-operator">=</span> <span class="cm-string">"i3.large"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">subnet_id</span> &nbsp; &nbsp; <span class="cm-operator">=</span> <span class="cm-variable">aws_subnet</span><span class="cm-operator">.</span><span class="cm-property">partition_subnet</span><span class="cm-operator">.</span><span class="cm-property">id</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">vpc_security_group_ids</span> <span class="cm-operator">=</span> [<span class="cm-variable">aws_security_group</span><span class="cm-operator">.</span><span class="cm-property">partition_sg</span><span class="cm-operator">.</span><span class="cm-property">id</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">placement_group</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-operator">=</span> <span class="cm-variable">aws_placement_group</span><span class="cm-operator">.</span><span class="cm-property">kafka_partition_pg</span><span class="cm-operator">.</span><span class="cm-property">id</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">tags</span> <span class="cm-operator">=</span> { <span class="cm-tag">Name</span> <span class="cm-operator">=</span> <span class="cm-string">"kafka-node-2"</span> }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">resource</span> <span class="cm-string">"aws_instance"</span> <span class="cm-string">"kafka_node_3"</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">ami</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-operator">=</span> <span class="cm-string">"ami-0c55b159cbfafe1f0"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">instance_type</span> <span class="cm-operator">=</span> <span class="cm-string">"i3.large"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">subnet_id</span> &nbsp; &nbsp; <span class="cm-operator">=</span> <span class="cm-variable">aws_subnet</span><span class="cm-operator">.</span><span class="cm-property">partition_subnet</span><span class="cm-operator">.</span><span class="cm-property">id</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">vpc_security_group_ids</span> <span class="cm-operator">=</span> [<span class="cm-variable">aws_security_group</span><span class="cm-operator">.</span><span class="cm-property">partition_sg</span><span class="cm-operator">.</span><span class="cm-property">id</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">placement_group</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-operator">=</span> <span class="cm-variable">aws_placement_group</span><span class="cm-operator">.</span><span class="cm-property">kafka_partition_pg</span><span class="cm-operator">.</span><span class="cm-property">id</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">tags</span> <span class="cm-operator">=</span> { <span class="cm-tag">Name</span> <span class="cm-operator">=</span> <span class="cm-string">"kafka-node-3"</span> }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 1568px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1568px;"></div></div></div></pre><h2 id='تسعير-الـ-instances'><strong><span>تسعير الـ Instances</span></strong></h2><p><span>أنت ممكن تشتري استخدام الـ </span><code>EC2 instances</code><span> بواحدة من تلات طرق.</span></p><h3 id='1-الـ-on-demand-model'><strong><span>1. الـ On-Demand Model</span></strong></h3><p><span>للشغل اللي هيفضل شغال على طول بس متوقع يشتغل أقل من 12 شهر، أنت في العادي بتدفع لكل ساعة الـ </span><code>instance</code><span> بتاعتك شغالة فيها. الـ </span><code>On-demand</code><span> ده أكتر طريقة مرنة، لأنك بتقدر تتحكم كويس أوي في اللي بتدفعه بإنك توقف وتشغل الـ </span><code>instances</code><span> حسب احتياجك. بس في المقابل، سعر الساعة فيه هو الأغلى.</span></p><h3 id='2-الـ-reserve-instance'><strong><span>2. الـ Reserve Instance</span></strong></h3><p><span>لو مخطط إنك تسيب السيرفرات شغالة 24 ساعة في اليوم لمدة أكتر من سنة، هتاخد خصم كبير أوي لو اشتريت </span><strong><span>reserve instance</span></strong><span> — وده بيبقى التزام منك لمدة سنة أو تلات سنين. ممكن تدفع تمن المدة كلها مقدم، أو تدفع جزء مقدم والباقي أقساط شهرية، أو تدفع كله أقساط شهرية (والسعر بيزيد شوية كل ما بتقلل المقدم). جدول 2.2 بيديلك فكرة عن إزاي الأسعار بتتغير بين الطريقتين.</span></p><p><strong><span>جدول 2.2: مقارنة تقديرية بين أسعار الـ On-demand والـ Reserve</span></strong>
<em><span>(الأسعار دي مجرد مثال)</span></em></p><figure class='table-figure'><table><thead><tr><th style='text-align:left;' ><span>نوع الـ Instance</span></th><th style='text-align:left;' ><span>طريقة التسعير</span></th><th style='text-align:left;' ><span>التكلفة/ساعة</span></th><th style='text-align:left;' ><span>التكلفة/سنة</span></th></tr></thead><tbody><tr><td style='text-align:left;' ><span>t2.micro</span></td><td style='text-align:left;' ><span>On-demand</span></td><td style='text-align:left;' ><span>0.0116 دولار</span></td><td style='text-align:left;' ><span>102.00 دولار</span></td></tr><tr><td style='text-align:left;' ><span>t2.micro</span></td><td style='text-align:left;' ><span>Reserve (لمدة 3 سنين)</span></td><td style='text-align:left;' >&nbsp;</td><td style='text-align:left;' ><strong><span>38.33 دولار</span></strong></td></tr><tr><td style='text-align:left;' ><span>g3.4xlarge</span></td><td style='text-align:left;' ><span>On-demand</span></td><td style='text-align:left;' ><span>1.14 دولار</span></td><td style='text-align:left;' ><span>9986.40 دولار</span></td></tr><tr><td style='text-align:left;' ><span>g3.4xlarge</span></td><td style='text-align:left;' ><span>Reserve (لمدة 3 سنين)</span></td><td style='text-align:left;' >&nbsp;</td><td style='text-align:left;' ><strong><span>4429.66 دولار</span></strong></td></tr></tbody></table></figure><p><span>تمام يا باشا، من غير تشبيهات. أهو الشرح المباشر بأسلوبنا:</span></p><hr /><h3 id='إيه-هو-الـ-spot-market'><strong><span>إيه هو الـ Spot Market؟</span></strong></h3><p><span>أمازون عندها عدد مهول من السيرفرات. في أي وقت، في جزء من السيرفرات دي بيبقى فاضي ومحدش بيستخدمه. بدل ما تسيبها مركونة، أمازون بتعرض السيرفرات الفاضية دي في سوق اسمه </span><strong><span>Spot Market</span></strong><span> بخصم كبير جدًا، ممكن يوصل لـ 90% من سعرها الأصلي (</span><code>On-Demand</code><span>).</span></p><h3 id='إزاي-بيشتغل'><strong><span>إزاي بيشتغل؟</span></strong></h3><ol start='' ><li><p><strong><span>أنت بتحدد سعرك:</span></strong><span> بتدخل على AWS وتقول: &quot;أنا عايز </span><code>instance</code><span> نوعها كذا، وأقصى سعر ممكن أدفعه في الساعة هو &quot;1&quot; دولار مثلا يعني&quot;. السعر ده هو الحد الأقصى بتاعك.</span></p></li><li><p><strong><span>AWS بتقارن الأسعار:</span></strong></p><ul><li><p><span>بتبص على السعر الحالي للـ </span><code>Spot instance</code><span> دي في السوق (وده سعر بيتغير كل شوية حسب العرض والطلب).</span></p></li><li><p><span>لو سعر السوق </span><strong><span>أقل من</span></strong><span> سعرك الأقصى، AWS بتشغلك الـ </span><code>instance</code><span> فورًا. وهتحاسبك على سعر السوق الرخيص، مش على سعرك الأقصى.</span></p></li><li><p><span>لو سعر السوق </span><strong><span>أعلى من</span></strong><span> سعرك الأقصى، مش هيشتغل حاجة وهتفضل مستني.</span></p></li></ul></li><li><p><strong><span>إيه اللي بيحصل والـ </span><code>Instance</code><span> شغالة؟</span></strong></p><ul><li><p><span>الـ </span><code>instance</code><span> بتاعتك هتفضل شغالة طول ما سعر السوق أقل من الحد الأقصى اللي أنت حاطه.</span></p></li><li><p><strong><span>اللحظة الحاسمة:</span></strong><span> لو الطلب على النوع ده من السيرفرات زاد فجأة، وسعر السوق علي وبقى </span><strong><span>أعلى من</span></strong><span> الحد الأقصى بتاعك، أمازون هتاخد منك الـ </span><code>instance</code><span>. هتبعتلك تحذير قبلها بدقيقتين، وبعدها الـ </span><code>instance</code><span> هتتقفل وتتشال.</span></p></li></ul></li></ol><h3 id='مين-بيستخدمه'><strong><span>مين بيستخدمه؟</span></strong></h3><p><span>الـ </span><code>Spot instances</code><span> دي مش لأي شغل. هي مناسبة جدًا للـ </span><code>workloads</code><span> اللي مش هيحصلها كارثة لو وقفت فجأة. زي مثلاً:</span></p><ul><li><p><span>تحليل كميات داتا ضخمة.</span></p></li><li><p><span>شغل الـ </span><code>rendering</code><span> بتاع الجرافيكس والفيديوهات.</span></p></li><li><p><span>الأبحاث العلمية اللي محتاجة قوة حسابية كبيرة.</span></p></li><li><p><span>أي شغل ممكن يتقسم على كذا سيرفر، ولو واحد وقع الباقي يكمل عادي.</span></p></li></ul><p><span>في الغالب بيبقى منطقي إنك تخلط بين أكتر من طريقة تسعير في نفس الـ </span><code>infrastructure</code><span>. مثلاً، محل أونلاين ممكن يشتري واحدة أو اتنين </span><code>reserve instances</code><span> عشان يغطي الطلب العادي بتاع العملاء، بس في نفس الوقت يسمح للـ </span><code>autoscaling</code><span> إنه يشغل </span><code>on-demand instances</code><span> أوتوماتيك في فترات الضغط العالي غير المتوقع.</span></p><p><img src="/home/Taha/.config/Typora/typora-user-images/image-20250619155517992.png" referrerpolicy="no-referrer" alt="image-20250619155517992"></p><p><span>تمام يا باشا، أهو شرح دورة حياة الـ Instance بأسلوبنا المعتاد.</span></p><hr /><h3 id='دورة-حياة-الـ-instance-instance-lifecycle'><strong><span>دورة حياة الـ Instance (Instance Lifecycle)</span></strong></h3><p><span>حالة أي </span><code>EC2 instance</code><span> شغالة ممكن تديرها بكذا طريقة.</span></p><h3 id='terminate-إنهاء-نهائي'><strong><span>Terminate (إنهاء نهائي)</span></strong></h3><p><span>ده معناه إنك بتقول لـ AWS: </span><strong><span>&quot;امسح السيرفر ده تمامًا ومش عايزه تاني&quot;</span></strong><span>.</span></p><ul><li><p><span>السيرفر بيتقفل وبيتحذف للأبد.</span></p></li><li><p><span>كل حاجة كانت عليه بتتمسح (إلا لو كنت مظبط الهارد الـ EBS إنه م يتمسحش).</span></p></li><li><p><span>بتوقف المحاسبة عليه نهائيًا.</span></p></li><li><p><strong><span>بتستخدمه لما تكون خلصت شغل بالسيرفر ومش هتحتاجه تاني خالص.</span></strong></p></li></ul><h3 id='stop-إيقاف-مؤقت'><strong><span>Stop (إيقاف مؤقت)</span></strong></h3><p><span>ده معناه إنك بتقول لـ AWS: </span><strong><span>&quot;اقفل السيرفر ده دلوقتي، بس خليهولي عشان هحتاجه تاني بعدين&quot;</span></strong><span>.</span></p><ul><li><p><span>السيرفر بيتقفل (زي ما بتعمل Shutdown للكمبيوتر بتاعك).</span></p></li><li><p><span>الداتا اللي على الهارد الـ </span><strong><span>EBS</span></strong><span> بتفضل زي ما هي ومبتتمسحش.</span></p></li><li><p><span>أمازون </span><strong><span>بتبطل تحاسبك على تمن السيرفر</span></strong><span> نفسه، بس بتفضل تحاسبك على تمن حجز الهارد (الـ EBS).</span></p></li><li><p><strong><span>بتستخدمه عشان توفر فلوس لما تكون مش محتاج السيرفر شغال دلوقتي (زي في الويك إند مثلاً).</span></strong></p></li></ul><div class="md-alert md-alert-warning warning"><p><span class='md-alert-text md-alert-text-warning'><svg viewBox="0 0 16 16" version="1.1" width="1em" height="1em" aria-hidden="true"><path d="M6.457 1.047c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0 1 14.082 15H1.918a1.75 1.75 0 0 1-1.543-2.575Zm1.763.707a.25.25 0 0 0-.44 0L1.698 13.132a.25.25 0 0 0 .22.368h12.164a.25.25 0 0 0 .22-.368Zm.53 3.996v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path></svg>Warning</span><br></p><p><span>لما بتعمل </span><code>terminate</code><span> للـ </span><code>instance</code><span> (يعني بتمسحها نهائيًا)، في معظم الحالات ده بيمسح كل الداتا اللي على الـ </span><code>primary storage</code><span> (الهارد الأساسي) بتاعها.</span></p><p><strong><span>إلا في حالة واحدة بس:</span></strong><span> لو كان الهارد ده من نوع </span><code>Elastic Block Store (EBS)</code><span> وأنت كنت ظابطه إنه </span><strong><span>يفضل موجود</span></strong><span> حتى بعد ما الـ </span><code>instance</code><span> بتاعته تتمسح.</span></p><p><span>بمعنى تاني، وإنت بتعمل الـ </span><code>instance</code><span>، في </span><code>option</code><span> اسمه </span><code>Delete on Termination</code><span>. لو شلت علامة الصح من عليه، الـ </span><code>EBS volume</code><span> ده هيفضل موجود وتقدر توصله بـ </span><code>instance</code><span> تانية بعدين.</span></p></div><p><strong><span>ملحوظة مهمة عن الـ IP:</span></strong>
<span>لازم تبقى عارف إن أي </span><code>instance</code><span> معمولة </span><code>stop</code><span> وكان معاها </span><code>public IP address</code><span> عادي، غالبًا هتاخد </span><code>IP address</code><span> مختلف لما تعملها </span><code>restart</code><span>. لو محتاج </span><code>IP address</code><span> ثابت ميتغيرش، لازم تعمل </span><code>allocate</code><span> لحاجة اسمها </span><strong><span>elastic IP address</span></strong><span> وتربطه بالـ </span><code>instance</code><span> بتاعتك لسه ليه يومه فى الفصل الرابع </span></p><h3 id='التعديل'><strong><span>التعديل </span></strong></h3><h4 id='1-تعديل-الـ-security-group-البودي-جارد-بتاع-السيرفر'><strong><span>1. تعديل الـ Security Group (البودي جارد بتاع السيرفر)</span></strong></h4><ul><li><p><strong><span>إزاي تعدله:</span></strong><span> تقدر تغير القواعد دي في أي وقت </span><strong><span>حتى والسيرفر شغال</span></strong><span>. مش محتاج تقفله خالص.</span></p></li><li><p><strong><span>مثال:</span></strong><span> لو عايز تفتح </span><code>port</code><span> جديد عشان تشغل خدمة عليه، أو تقفل </span><code>port</code><span> عشان تزود الأمان، تقدر تعمل كده فورًا والتغيير بيتطبق في ساعتها.</span></p></li></ul><h4 id='2-تعديل-الـ-instance-type-حجم-وقوة-السيرفر'><strong><span>2. تعديل الـ Instance Type (حجم وقوة السيرفر)</span></strong></h4><ul><li><p><strong><span>إيه هو:</span></strong><span> ده نوع السيرفر اللي بيحدد قوة الـ </span><code>CPU</code><span> وحجم الـ </span><code>Memory</code><span> بتاعته (مثلاً من </span><code>t2.micro</code><span> لـ </span><code>t3.large</code><span>).</span></p></li><li><p><strong><span>إزاي تعدله:</span></strong><span> عشان تغير حجم السيرفر، </span><strong><span>لازم تقفله الأول</span></strong><span>.</span></p><ol start='' ><li><p><span>بتعمل </span><strong><code>Stop</code></strong><span> للسيرفر.</span></p></li><li><p><span>بتغير الـ </span><code>Instance Type</code><span> للحجم الجديد اللي أنت عايزه.</span></p></li><li><p><span>بتعمل </span><strong><code>Restart</code></strong><span> للسيرفر تاني.</span></p></li></ol></li><li><p><strong><span>مثال:</span></strong><span> لو لقيت الـ </span><code>application</code><span> بتاعك بطيء ومحتاج </span><code>memory</code><span> أكتر، ممكن تكبر حجم السيرفر بسهولة عن طريق الخطوات دي.</span></p></li></ul><p><span>عشان امنع انه يمسح EBS بتاعه لما امسح EC2 </span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="terraform" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="terraform"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 17.0231px; left: 7.6302px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 3. Create the EC2 Instance</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">resource</span> <span class="cm-string">"aws_instance"</span> <span class="cm-string">"my_server"</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">ami</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-operator">=</span> <span class="cm-variable">data</span><span class="cm-operator">.</span><span class="cm-property">aws_ami</span><span class="cm-operator">.</span><span class="cm-property">amazon_linux_2</span><span class="cm-operator">.</span><span class="cm-property">id</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">instance_type</span> <span class="cm-operator">=</span> <span class="cm-string">"t2.micro"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># --- هنا النقطة المهمة ---</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">root_block_device</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">delete_on_termination</span> <span class="cm-operator">=</span> <span class="cm-keyword">false</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">    </span><span class="cm-comment"># -------------------------------</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 314px;"></div><div class="CodeMirror-gutters" style="display: none; height: 314px;"></div></div></div></pre><div class="md-alert md-alert-note note"><p><span class='md-alert-text md-alert-text-note'><svg viewBox="0 0 16 16" version="1.1" width="1em" height="1em" aria-hidden="true"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path></svg>Note</span><br></p><p>&nbsp;</p><p><strong><span>ممكن تمنع مسح اي resource عن طريق</span></strong></p><p><strong><code>lifecycle { prevent_destroy = true }</code><span> ؟</span></strong></p><p><span>ده عامل زي ما تكون بتحط </span><strong><span>&quot;قفل أمان&quot;</span></strong><span> على حاجة مهمة جدًا في الكود بتاعك.</span></p><p><strong><span>ببساطة شديدة:</span></strong>
<span>لما بتحط الكود ده جوه أي </span><code>resource</code><span> في Terraform، أنت بتقول لـ Terraform:</span>
<strong><span>&quot;يا Terraform، الـ resource ده بالذات، ممنوع تمسحه تحت أي ظرف من الظروف. لو أنا أو أي حد بالغلط كتب </span><code>terraform destroy</code><span>، أو حاول يعمل أي تعديل يخليه يتمسح، وقّف كل حاجة وطلع </span><code>error</code><span>.&quot;</span></strong></p></div><p>&nbsp;</p><h2 id='الـ-resource-tags'><strong><span>الـ Resource Tags</span></strong></h2><p><span>كل ما بتعمل </span><code>deploy</code><span> لـ </span><code>resources</code><span> أكتر على الـ </span><code>account</code><span> بتاعك، بيبقى أصعب إنك تتابع كل حاجة وتفضل فاكرها. لما يبقى عندك عدد متغير من الـ </span><code>EC2 instances</code><span>، ومعاهم الـ </span><code>storage volumes</code><span> والـ </span><code>security groups</code><span> والـ </span><code>elastic IPs</code><span> بتاعتهم، وكل دول متوزعين على اتنين أو تلاتة </span><code>VPCs</code><span>، الدنيا ممكن تتعقد منك.</span></p><p><span>أحسن طريقة عشان تسيطر على الفوضى دي هي إنك تلاقي طريقة تعرف بيها كل </span><code>resource</code><span> عندك بسرعة، وتعرف إيه وظيفته وعلاقته بالـ </span><code>resources</code><span> التانية. وأحسن طريقة تعمل بيها كده هي إنك تعمل </span><strong><span>نظام تسمية ثابت</span></strong><span> وتطبقه عن طريق الـ </span><strong><span>Tags</span></strong><span>.</span></p><p><span>الـ </span><code>AWS resource tags</code><span> ممكن تستخدمها عشان تحط &quot;يافطة&quot; على أي حاجة هتلمسها في الـ </span><code>account</code><span> بتاعك — هي مش مقتصرة على الـ EC2 بس. الـ </span><code>Tag</code><span> بيبقى ليه </span><strong><code>Key</code></strong><span>، وممكن يبقى ليه </span><strong><code>Value</code></strong><span>.</span></p><p><strong><span>مثال:</span></strong>
<span>ممكن تعمل </span><code>tag</code><span> الـ </span><code>key</code><span> بتاعه اسمه </span><code>production-server</code><span> وتحطه على كل حاجة ليها علاقة بالبيئة الـ </span><code>production</code><span> بتاعتك. والـ </span><code>instances</code><span> نفسها ممكن تاخد </span><code>value</code><span> زي </span><code>server1</code><span> و </span><code>server2</code><span> وهكذا. والـ </span><code>security group</code><span> بتاعتهم ممكن تاخد نفس الـ </span><code>key</code><span> اللي هو </span><code>production-server</code><span> بس الـ </span><code>value</code><span> تبقى </span><code>security-group1</code><span>.</span></p><p><span>جدول 2.3 بيوضح إزاي نظام التسمية ده ممكن يشتغل على </span><code>deployment</code><span> أكبر شوية.</span></p><h3 id='جدول-23-مثال-على-نظام-تسمية-بالـ-keyvalue'><strong><span>جدول 2.3: مثال على نظام تسمية بالـ Key/Value</span></strong></h3><figure class='table-figure'><table><thead><tr><th style='text-align:left;' ><span>الـ Key (المفتاح)</span></th><th style='text-align:left;' ><span>الـ Value (القيمة)</span></th></tr></thead><tbody><tr><td style='text-align:left;' ><strong><span>production-server</span></strong></td><td style='text-align:left;' ><span>server1</span></td></tr><tr><td style='text-align:left;' ><strong><span>production-server</span></strong></td><td style='text-align:left;' ><span>server2</span></td></tr><tr><td style='text-align:left;' ><strong><span>production-server</span></strong></td><td style='text-align:left;' ><span>security-group1</span></td></tr><tr><td style='text-align:left;' ><strong><span>staging-server</span></strong></td><td style='text-align:left;' ><span>server1</span></td></tr><tr><td style='text-align:left;' ><strong><span>staging-server</span></strong></td><td style='text-align:left;' ><span>server2</span></td></tr><tr><td style='text-align:left;' ><strong><span>staging-server</span></strong></td><td style='text-align:left;' ><span>security-group1</span></td></tr><tr><td style='text-align:left;' ><strong><span>test-server</span></strong></td><td style='text-align:left;' ><span>server1</span></td></tr><tr><td style='text-align:left;' ><strong><span>test-server</span></strong></td><td style='text-align:left;' ><span>security-group1</span></td></tr></tbody></table></figure><p><span>لما تطبق الـ </span><code>Tags</code><span> صح، ده بيحسّن </span><strong><span>رؤيتك</span></strong><span> للـ </span><code>resources</code><span> بتاعتك، وبيخلي إدارتها أسهل بكتير، وبيساعدك تراجع وتتحكم في التكاليف والفواتير، وبتتجنب أخطاء غالية.</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="terraform" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="terraform"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 17.0241px; left: 7.6302px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">resource</span> <span class="cm-string">"aws_instance"</span> <span class="cm-string">"my_server"</span> {</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">ami</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-operator">=</span> <span class="cm-variable">data</span><span class="cm-operator">.</span><span class="cm-property">aws_ami</span><span class="cm-operator">.</span><span class="cm-property">amazon_linux_2</span><span class="cm-operator">.</span><span class="cm-property">id</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">instance_type</span> <span class="cm-operator">=</span> <span class="cm-string">"t2.micro"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">root_block_device</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">delete_on_termination</span> <span class="cm-operator">=</span> <span class="cm-keyword">false</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">tags</span> <span class="cm-operator">=</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-tag">Name</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-operator">=</span> <span class="cm-string">"Server-With-Persistent-Disk"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-string">"production-server"</span> <span class="cm-operator">=</span> <span class="cm-string">"server1"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 314px;"></div><div class="CodeMirror-gutters" style="display: none; height: 314px;"></div></div></div></pre><p>&nbsp;</p><h2 id='حدود-الخدمات-service-limits'><strong><span>حدود الخدمات (Service Limits)</span></strong></h2><p><span>بشكل افتراضي، كل </span><code>AWS account</code><span> بيبقى ليه حدود على عدد الـ </span><code>instances</code><span> اللي تقدر تشغلها من خدمة معينة. أحيانًا الحدود دي بتبقى على مستوى </span><strong><code>region</code><span> واحدة</span></strong><span> جوه الـ </span><code>account</code><span>، وأحيانًا تانية بتبقى حدود </span><strong><span>عالمية</span></strong><span> (</span><code>global</code><span>) على الـ </span><code>account</code><span> كله.</span></p><p><strong><span>كمثال:</span></strong></p><ul><li><p><span>مسموحلك تعمل </span><strong><span>5 VPCs بس لكل </span><code>region</code></strong><span>.</span></p></li><li><p><span>ومسموحلك تعمل </span><strong><span>5,000 SSH key pair بس على مستوى الـ </span><code>account</code><span> كله</span></strong><span>.</span></p></li></ul><p><span>لو احتجت، ممكن تطلب من AWS إنها ترفعلك الحد الأقصى ده لخدمة معينة.</span></p><p><span>لو عايز تعرف تفاصيل محدّثة عن حدود كل خدمات AWS، هتلاقيها على اللينك ده:</span>
<code>docs.aws.amazon.com/general/latest/gr/aws_service_limits.html</code></p><p>&nbsp;</p><h2 id='الـ-storage-volumes-بتاعة-الـ-ec2'><strong><span>الـ Storage Volumes بتاعة الـ EC2</span></strong></h2><p><span>الـ </span><code>Storage drives</code><span> (أو </span><code>volumes</code><span> زي ما AWS بتسميها) دي في الغالب بتبقى مساحات </span><code>virtual</code><span> متقطعة من </span><code>physical drives</code><span> أكبر. بس بالنسبة للـ </span><code>OS</code><span> اللي شغال على الـ </span><code>instance</code><span> بتاعتك، كل الـ </span><code>volumes</code><span> دي بتظهرله كأنها بالظبط </span><code>physical drives</code><span> عادية. بس في الحقيقة في أكتر من نوع </span><code>volume</code><span> في AWS، ومهم أوي تفهم كل نوع شغال إزاي.</span></p><h3 id='الـ-elastic-block-store-ebs-volumes'><strong><span>الـ Elastic Block Store (EBS) Volumes</span></strong></h3><p><span>أنت ممكن mount أي عدد من الـ </span><code>EBS volumes</code><span> على الـ </span><code>instance</code><span> بتاعتك زي ما أنت عايز (بس خلي بالك، الـ </span><code>volume</code><span> الواحد مينفعش يتعمله mount على أكتر من </span><code>instance</code><span> واحدة في نفس الوقت) وتستخدمهم بالظبط زي ما بتستخدم أي هارد ديسك عادي. وزي الهاردات العادية، النوع اللي هتختاره هيأثر على الأداء والتكلفة.</span></p><p><span>AWS بتضمنلك الـ </span><code>reliability</code><span> بتاعت الداتا اللي بتخزنها على الـ </span><code>EBS</code><span> (بتوعدك بـ 99.99% </span><code>availability</code><span> على الأقل)، فمتشلش هم إن الداتا تضيع. لما </span><code>EBS drive</code><span> بيعطل، الداتا بتاعته بتبقى متاخد منها نسخة أصلاً وغالبًا بترجع تشتغل تاني قبل ما حد ياخد باله من المشكلة. فعمليًا، الحاجة الوحيدة اللي المفروض تقلقك هي إزاي هتوصل للداتا بتاعتك بسرعة وكفاءة.</span></p><p><span>حالياً في أربع أنواع </span><code>EBS</code><span>، اتنين بيستخدموا تكنولوجيا الـ </span><strong><span>SSD</span></strong><span> السريعة، واتنين بيستخدموا الـ </span><strong><span>HDD</span></strong><span> القديمة الأبطأ. أداء كل نوع بيتقاس بأقصى </span><strong><span>IOPS/volume</span></strong><span> (والـ IOPS دي معناها عدد عمليات القراءة والكتابة في الثانية).</span></p><h4 id='1-ebs-provisioned-iops-ssd'><strong><span>1. EBS-Provisioned IOPS SSD</span></strong></h4><p><span>لو الـ </span><code>applications</code><span> بتاعتك محتاجة معدل </span><code>I/O</code><span> (عمليات قراءة وكتابة) عنيف جدًا، يبقى لازم تفكر في النوع ده. ده بيديلك أعلى أداء ممكن يوصل لـ </span><strong><span>64,000 IOPS</span></strong><span>. بس طبعًا ده أغلى نوع.</span></p><ul><li><p><span>بتستخدم gp2 (الجيل القديم) أو gp3 (الجيل الأحدث والأفضل).</span></p><p>&nbsp;</p></li></ul><h4 id='2-ebs-general-purpose-ssd'><strong><span>2. EBS General-Purpose SSD</span></strong></h4><p><span>لمعظم شغل السيرفرات العادي اللي محتاج أداء سريع وتأخير قليل (</span><code>low-latency</code><span>)، النوع ده هيبقى تمام وزي الفل. بيديلك لحد </span><strong><span>16,000 IOPS</span></strong><span>. ده الاختيار اللي معظم الناس بتستخدمه.</span></p><ul><li><p><span>بتستخدم io1 أو io2.</span></p></li><li><p><span>بس هنا تحديد لازم تحجز </span><code>iops = --</code></p></li></ul><h4 id='3-throughput-optimized-hdd'><strong><span>3. Throughput-Optimized HDD</span></strong></h4><p><span>النوع ده بيوفرلك في التكلفة وبيديلك أداء مقبول لو شغلك بيعتمد على نقل كميات داتا كبيرة مرة واحدة (</span><code>throughput-intensive</code><span>)، زي تحليل الـ </span><code>logs</code><span> أو عمليات الـ </span><code>big data</code><span>. هو مش سريع في العمليات الصغيرة الكتير (آخره </span><strong><span>500 IOPS</span></strong><span>)، بس شاطر في نقل الملفات الكبيرة.</span></p><ul><li><p><span>بتستخدم </span><strong><span>st1</span></strong><span>.</span></p></li></ul><h4 id='4-cold-hdd'><strong><span>4. Cold HDD</span></strong></h4><p><span>لما تكون بتتعامل مع كميات داتا كبيرة بس نادرًا لما بتحتاج توصلها، النوع ده ممكن يكون مناسب ليك. أداؤه قليل (</span><strong><span>250 IOPS</span></strong><span>)، بس في المقابل هو أرخص نوع فيهم خالص.</span></p><ul><li><h3 id='sc1'><strong><span>sc1</span></strong></h3></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="terraform" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="terraform"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 17.0241px; left: 7.6302px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">resource</span> <span class="cm-string">"aws_instance"</span> <span class="cm-string">"my_server"</span> {</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># -----------------</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">root_block_device</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">volume_size</span> <span class="cm-operator">=</span> <span class="cm-number">30</span> &nbsp; &nbsp; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">volume_type</span> <span class="cm-operator">=</span> <span class="cm-string">"gp3"</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># false = لا تحذف الهارد عند إنهاء السيرفر</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">delete_on_termination</span> <span class="cm-operator">=</span> <span class="cm-keyword">false</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># ------------------------</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 314px;"></div><div class="CodeMirror-gutters" style="display: none; height: 314px;"></div></div></div></pre><p>&nbsp;</p><hr /><h3 id='جدول-24-مقارنة-بين-أنواع-الـ-ebs-الأربعة'><strong><span>جدول 2.4: مقارنة بين أنواع الـ EBS الأربعة</span></strong></h3><figure class='table-figure'><table><thead><tr><th style='text-align:left;' ><span>النوع</span></th><th style='text-align:left;' ><span>حجم الـ Volume</span></th><th style='text-align:left;' ><span>IOPS</span></th><th style='text-align:left;' ><span>Throughput (MB/s)</span></th><th style='text-align:left;' ><span>السعر (شهريًا)  </span><em><span>كمثال</span></em></th></tr></thead><tbody><tr><td style='text-align:left;' ><strong><span>Provisioned IOPS SSD</span></strong></td><td style='text-align:left;' ><span>4 GB 16 TB</span></td><td style='text-align:left;' ><span>64,000</span></td><td style='text-align:left;' ><span>1,000</span></td><td style='text-align:left;' ><mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg xmlns="http://www.w3.org/2000/svg" width="11.541ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 5101 1000" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" style="vertical-align: -0.566ex;"><defs><path id="MJX-2-TEX-N-30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path><path id="MJX-2-TEX-N-2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path><path id="MJX-2-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-2-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-2-TEX-N-35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path><path id="MJX-2-TEX-N-2F" d="M423 750Q432 750 438 744T444 730Q444 725 271 248T92 -240Q85 -250 75 -250Q68 -250 62 -245T56 -231Q56 -221 230 257T407 740Q411 750 423 750Z"></path><path id="MJX-2-TEX-I-1D43A" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q492 659 471 656T418 643T357 615T294 567T236 496T189 394T158 260Q156 242 156 221Q156 173 170 136T206 79T256 45T308 28T353 24Q407 24 452 47T514 106Q517 114 529 161T541 214Q541 222 528 224T468 227H431Q425 233 425 235T427 254Q431 267 437 273H454Q494 271 594 271Q634 271 659 271T695 272T707 272Q721 272 721 263Q721 261 719 249Q714 230 709 228Q706 227 694 227Q674 227 653 224Q646 221 643 215T629 164Q620 131 614 108Q589 6 586 3Q584 1 581 1Q571 1 553 21T530 52Q530 53 528 52T522 47Q448 -22 322 -22Q201 -22 126 55T50 252Z"></path><path id="MJX-2-TEX-I-1D435" d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path><path id="MJX-2-TEX-N-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mn"><use data-c="30" xlink:href="#MJX-2-TEX-N-30"></use><use data-c="2E" xlink:href="#MJX-2-TEX-N-2E" transform="translate(500,0)"></use><use data-c="31" xlink:href="#MJX-2-TEX-N-31" transform="translate(778,0)"></use><use data-c="32" xlink:href="#MJX-2-TEX-N-32" transform="translate(1278,0)"></use><use data-c="35" xlink:href="#MJX-2-TEX-N-35" transform="translate(1778,0)"></use></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(2278,0)"><g data-mml-node="mo"><use data-c="2F" xlink:href="#MJX-2-TEX-N-2F"></use></g></g><g data-mml-node="mi" transform="translate(2778,0)"><use data-c="1D43A" xlink:href="#MJX-2-TEX-I-1D43A"></use></g><g data-mml-node="mi" transform="translate(3564,0)"><use data-c="1D435" xlink:href="#MJX-2-TEX-I-1D435"></use></g><g data-mml-node="mo" transform="translate(4323,0)"><use data-c="2B" xlink:href="#MJX-2-TEX-N-2B"></use></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0.125</mn><mrow data-mjx-texclass="ORD"><mo>/</mo></mrow><mi>G</mi><mi>B</mi><mo>+</mo></math></mjx-assistive-mml></mjx-container><script type="math/tex">0.125/GB + </script><span>0.065/IOPS</span></td></tr><tr><td style='text-align:left;' ><strong><span>General-Purpose SSD</span></strong></td><td style='text-align:left;' ><span>1 GB  16 TB</span></td><td style='text-align:left;' ><span>16,000</span></td><td style='text-align:left;' ><span>250</span></td><td style='text-align:left;' ><span>$0.10/GB</span></td></tr><tr><td style='text-align:left;' ><strong><span>Throughput-Optimized HDD</span></strong></td><td style='text-align:left;' ><span>500 GB 16 TB</span></td><td style='text-align:left;' ><span>500</span></td><td style='text-align:left;' ><span>500</span></td><td style='text-align:left;' ><span>$0.045/GB</span></td></tr><tr><td style='text-align:left;' ><strong><span>Cold HDD</span></strong></td><td style='text-align:left;' ><span>500 GB 16 TB</span></td><td style='text-align:left;' ><span>250</span></td><td style='text-align:left;' ><span>250</span></td><td style='text-align:left;' ><span>$0.025/GB</span></td></tr></tbody></table></figure><hr /><h3 id='مميزات-الـ-ebs-volume'><strong><span>مميزات الـ EBS Volume</span></strong></h3><ul><li><p><strong><span>الـ Snapshots (الباك أب):</span></strong><span> كل أنواع الـ </span><code>EBS</code><span> ممكن تاخد منها نسخة عن طريق إنك تعمل </span><code>snapshot</code><span>. والـ </span><code>snapshots</code><span> دي ممكن تستخدمها عشان تعمل </span><code>volumes</code><span> تانية جديدة، أو تشاركها مع ناس تانية، أو تحولها لـ </span><code>images</code><span> عشان تعمل منها </span><code>AMI</code><span> متقلقش هتشوفه ازاي بيحصل قدام عندنا شابتر كامل عن storage</span></p></li><li><p><strong><span>التشفير (Encryption):</span></strong><span> الـ </span><code>EEBS volumes</code><span> ممكن تتشفر عشان تحمي الداتا بتاعتك وهي متخزنة أو وهي بتتنقل. AWS ممكن تدير مفاتيح التشفير دي بنفسها، أو تستخدم مفاتيح أنت اللي بتديها لها عن طريق خدمة </span><strong><span>AWS Key Management Service (KMS)</span></strong><span>.</span></p></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="terraform"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="terraform"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 17.0231px; left: 7.6302px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">resource</span> <span class="cm-string">"aws_instance"</span> <span class="cm-string">"my_encrypted_server"</span> {</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">root_block_device</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">encrypted</span> <span class="cm-operator">=</span> <span class="cm-keyword">true</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># kms_key_id = "alias/aws/ebs" # Using AWS managed key for EBS encryption</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># this default mode is sufficient for most use cases made aws manage encryption of ebs</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># تقدر تحط المفتاح اللي انت عايز زي ما انت عايز </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 336px;"></div><div class="CodeMirror-gutters" style="display: none; height: 336px;"></div></div></div></pre><p>&nbsp;</p><p>&nbsp;</p><hr /><p><img src="/home/Taha/.config/Typora/typora-user-images/image-20250619180302446.png" referrerpolicy="no-referrer" alt="image-20250619180302446"></p><h2 id='الـ-instance-store-volumes-الهاردات-المؤقتة'><strong><span>الـ Instance Store Volumes (الهاردات المؤقتة)</span></strong></h2><p><span>على عكس الـ </span><code>EBS volumes</code><span>، الـ </span><code>instance store volumes</code><span> دي </span><strong><span>مؤقتة (</span><code>ephemeral</code><span>)</span></strong><span>. وده معناه إن لما الـ </span><code>instance</code><span> اللي هي متركبة عليها بتتقفل، الداتا بتاعتها </span><strong><span>بتضيع للأبد</span></strong><span>.</span></p><p><strong><span>طب ليه ممكن حد يستخدمها أصلاً بدل الـ EBS؟</span></strong></p><ul><li><p><strong><span>السرعة الخارقة:</span></strong>
<span>الـ </span><code>Instance store volumes</code><span> دي عبارة عن هاردات </span><code>SSD</code><span> متركبة </span><strong><span>جوه السيرفر الـ </span><code>physical</code><span> نفسه</span></strong><span> اللي الـ </span><code>instance</code><span> بتاعتك شغالة عليه، ومتوصلة عن طريق واجهة </span><code>NVMe</code><span> سريعة جدًا.</span></p></li><li><p><strong><span>ببلاش:</span></strong>
<span>استخدام الـ </span><code>instance store volumes</code><span> بيبقى داخل في تمن الـ </span><code>instance</code><span> نفسها، مش بتدفع عليه فلوس زيادة.</span></p></li><li><p><strong><span>مناسبة للشغل المؤقت:</span></strong>
<span>الـ </span><code>Instance store</code><span> بتبقى ممتازة في الموديلات اللي الـ </span><code>instances</code><span> فيها بتشتغل عشان تعمل مهمة قصيرة وتروح لحالها (زي في الـ </span><code>autoscaling groups</code><span> مثلاً). بتجيب الداتا بتاعتها من بره، تعمل شغلها، وفي الآخر بتترمى ومحدش بيزعل عليها.</span></p></li></ul><p><span>حجم instance volume  بيعتمد على </span><strong><span>نوع الـ </span><code>instance</code></strong><span> اللي بتختاره. ودي نقطة مهمة لازم تاخدها في اعتبارك وإنت بتخطط للشغل بتاعك.</span></p><hr /><p><span>وحتى مع كل مميزات الـ </span><code>EBS</code><span> والـ </span><code>Instance Store</code><span>، مهم تبقى عارف إن في حالات بيبقى أحسنلك بكتير إنك تخلي الداتا الكبيرة </span><strong><span>بره الـ EC2 خالص</span></strong><span>. في حالات استخدام كتير، خدمة </span><strong><span>Amazon S3</span></strong><span> ممكن تبقى طريقة أرخص بكتير جدًا عشان تخزن ملفات أو حتى </span><code>databases</code><span>، وفي نفس الوقت بتبقى متاحة فورًا لعمليات ال-</span><code>compute</code><span>. (هنتعلم أكتر عن ده في شابتر 3).</span></p><h3 id='الزتونة-من-الآخر'><strong><span>الزتونة (من الآخر):</span></strong></h3><ul><li><p><strong><span>الـ EBS Volumes:</span></strong><span> هي غالبًا الاختيار الصح للـ </span><code>instances</code><span> اللي الداتا بتاعتها </span><strong><span>لازم تفضل موجودة</span></strong><span> بعد الـ </span><code>reboot</code><span>.</span></p></li><li><p><strong><span>الـ Instance Store Volumes:</span></strong><span> بتبقى مفيدة (لو متاحة) للعمليات اللي محتاجة وصول سريع جدًا (</span><code>low-latency</code><span>) لكميات داتا كبيرة </span><strong><span>مش مهم إنها تفضل موجودة</span></strong><span> لو حصل عطل أو </span><code>reboot</code><span>.</span></p></li><li><p><strong><span>التخزين بره الـ EC2 (زي S3):</span></strong><span> بيبقى حل كويس لما تكون مش محتاج سرعات قراءة وكتابة خرافية، بس عايز تستمتع بالمرونة والتوفير بتاع S3.</span></p></li></ul><h2 id='إزاي-توصل-للـ-ec2-instance-بتاعتك'><strong><span>إزاي توصل للـ EC2 Instance بتاعتك</span></strong></h2><p><span>زي أي جهاز على شبكة، الـ </span><code>EC2 instances</code><span> بتتعرف بـ </span><code>IP addresses</code><span> مميزة. كل </span><code>instance</code><span> بتاخد على الأقل </span><strong><code>private IPv4 address</code></strong><span> واحد، واللي بشكل افتراضي بيبقى من ضمن النطاقات اللي في جدول 2.5.</span></p><h4 id='جدول-25-نطاقات-الـ-ip-المستخدمة-في-الشبكات-الخاصة-private-networks'><strong><span>جدول 2.5: نطاقات الـ IP المستخدمة في الشبكات الخاصة (Private Networks)</span></strong></h4><figure class='table-figure'><table><thead><tr><th style='text-align:left;' ><span>من</span></th><th style='text-align:left;' ><span>إلى</span></th></tr></thead><tbody><tr><td style='text-align:left;' ><span>10.0.0.0</span></td><td style='text-align:left;' ><span>10.255.255.255</span></td></tr><tr><td style='text-align:left;' ><span>172.16.0.0</span></td><td style='text-align:left;' ><span>172.31.255.255</span></td></tr><tr><td style='text-align:left;' ><span>192.168.0.0</span></td><td style='text-align:left;' ><span>192.168.255.255</span></td></tr></tbody></table></figure><p><span>لما بتعمل </span><code>EC2 instance</code><span> جديد على AWS، هو في الأول بيبقى زي جهاز كمبيوتر مقفول عليه جوه شبكة داخلية خاصة بيك، وبيبقى معاه </span><code>private IP address</code><span> بس عشان الأجهزة اللي معاه في نفس الشبكة دي تعرف تكلمه. في الوضع ده، السيرفر بيبقى معزول تمامًا، يعني لا هو بيعرف يوصل للإنترنت ولا الإنترنت بيعرف يوصله، وده طبعًا عشان الأمان.</span></p><p><span>بس في الغالب أنت بتبقى محتاج السيرفر ده يتصل بالإنترنت عشان تنزل عليه برامج مثلاً، أو عشان الناس من بره توصله لو هو </span><code>web server</code><span>. عشان تعمل كده، بتخليه ياخد </span><code>public IP address</code><span>. بس لازم تبقى عارف إن الـ </span><code>public IP</code><span> العادي ده مؤقت، يعني لو عملت </span><code>stop</code><span> للسيرفر وبعدين شغلته تاني، غالبًا هياخد </span><code>IP</code><span> جديد، وده طبعًا مش هينفع لو عندك شغل محتاج عنوان ثابت.</span></p><p><span>عشان تحل المشكلة دي، أمازون بتديلك حاجة اسمها </span><code>elastic IP</code><span>، وده عبارة عن </span><code>public IP</code><span> ثابت بتحجزه لنفسك ومبيتغيرش أبدًا، وتقدر تفكه من سيرفر وتركبه في سيرفر تاني، وطول ما هو متركب على سيرفر شغال، مش بتدفع عليه فلوس.</span></p><p><span>ولو احتجت إن السيرفر بتاعك يتصل بأكتر من شبكة داخلية في نفس الوقت، ممكن تركب عليه أكتر من كارت شبكة، اللي بنسميها </span><code>elastic network interfaces</code><span>، وكل كارت منهم بيبقى متوصل بـ </span><code>subnet</code><span> و</span><code>security group</code><span> مختلفين.</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="terraform" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="terraform"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 17.0234px; left: 7.6302px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">provider</span> <span class="cm-string">"aws"</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">region</span> <span class="cm-operator">=</span> <span class="cm-string">"us-west-2"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">resource</span> <span class="cm-string">"aws_vpc"</span> <span class="cm-string">"multi_home_vpc"</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">cidr_block</span> <span class="cm-operator">=</span> <span class="cm-string">"10.50.0.0/16"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">enable_dns_support</span> &nbsp; <span class="cm-operator">=</span> <span class="cm-keyword">true</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">enable_dns_hostnames</span> <span class="cm-operator">=</span> <span class="cm-keyword">true</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">tags</span> <span class="cm-operator">=</span> { <span class="cm-tag">Name</span> <span class="cm-operator">=</span> <span class="cm-string">"MultiHomed-VPC"</span> }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># private subnet </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">resource</span> <span class="cm-string">"aws_subnet"</span> <span class="cm-string">"public_subnet"</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">vpc_id</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-operator">=</span> <span class="cm-variable">aws_vpc</span><span class="cm-operator">.</span><span class="cm-property">multi_home_vpc</span><span class="cm-operator">.</span><span class="cm-property">id</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">cidr_block</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-operator">=</span> <span class="cm-string">"10.50.1.0/24"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">availability_zone</span> &nbsp; &nbsp; &nbsp; <span class="cm-operator">=</span> <span class="cm-string">"us-west-2a"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">map_public_ip_on_launch</span> <span class="cm-operator">=</span> <span class="cm-keyword">true</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">tags</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-operator">=</span> { <span class="cm-tag">Name</span> <span class="cm-operator">=</span> <span class="cm-string">"Public-Subnet"</span> }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># public subnet </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">resource</span> <span class="cm-string">"aws_subnet"</span> <span class="cm-string">"private_subnet"</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">vpc_id</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-operator">=</span> <span class="cm-variable">aws_vpc</span><span class="cm-operator">.</span><span class="cm-property">multi_home_vpc</span><span class="cm-operator">.</span><span class="cm-property">id</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">cidr_block</span> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-operator">=</span> <span class="cm-string">"10.50.2.0/24"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">availability_zone</span> <span class="cm-operator">=</span> <span class="cm-string">"us-west-2a"</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">tags</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-operator">=</span> { <span class="cm-tag">Name</span> <span class="cm-operator">=</span> <span class="cm-string">"Private-Subnet"</span> }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data</span> <span class="cm-string">"aws_ami"</span> <span class="cm-string">"amazon_linux_2"</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">most_recent</span> <span class="cm-operator">=</span> <span class="cm-keyword">true</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">owners</span> &nbsp; &nbsp; &nbsp;<span class="cm-operator">=</span> [<span class="cm-string">"amazon"</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">filter</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">name</span> &nbsp; <span class="cm-operator">=</span> <span class="cm-string">"name"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">values</span> <span class="cm-operator">=</span> [<span class="cm-string">"amzn2-ami-hvm-*-x86_64-gp2"</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">resource</span> <span class="cm-string">"aws_instance"</span> <span class="cm-string">"multi_homed_server"</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">ami</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-operator">=</span> <span class="cm-variable">data</span><span class="cm-operator">.</span><span class="cm-property">aws_ami</span><span class="cm-operator">.</span><span class="cm-property">amazon_linux_2</span><span class="cm-operator">.</span><span class="cm-property">id</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">instance_type</span> <span class="cm-operator">=</span> <span class="cm-string">"t3.micro"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">subnet_id</span> <span class="cm-operator">=</span> <span class="cm-variable">aws_subnet</span><span class="cm-operator">.</span><span class="cm-property">public_subnet</span><span class="cm-operator">.</span><span class="cm-property">id</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">tags</span> <span class="cm-operator">=</span> { <span class="cm-tag">Name</span> <span class="cm-operator">=</span> <span class="cm-string">"Multi-Homed-Server"</span> }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">resource</span> <span class="cm-string">"aws_network_interface"</span> <span class="cm-string">"private_eni"</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">subnet_id</span> &nbsp; &nbsp; &nbsp; <span class="cm-operator">=</span> <span class="cm-variable">aws_subnet</span><span class="cm-operator">.</span><span class="cm-property">private_subnet</span><span class="cm-operator">.</span><span class="cm-property">id</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">private_ips</span> &nbsp; &nbsp; <span class="cm-operator">=</span> [<span class="cm-string">"10.50.2.50"</span>] </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">security_groups</span> <span class="cm-operator">=</span> [<span class="cm-variable">aws_security_group</span><span class="cm-operator">.</span><span class="cm-property">private_sg</span><span class="cm-operator">.</span><span class="cm-property">id</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">tags</span> <span class="cm-operator">=</span> { <span class="cm-tag">Name</span> <span class="cm-operator">=</span> <span class="cm-string">"Private-ENI"</span> }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># 3. نركب الكارت التاني ده في السيرفر بتاعنا</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">resource</span> <span class="cm-string">"aws_network_interface_attachment"</span> <span class="cm-string">"eni_attachment"</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">instance_id</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-operator">=</span> <span class="cm-variable">aws_instance</span><span class="cm-operator">.</span><span class="cm-property">multi_homed_server</span><span class="cm-operator">.</span><span class="cm-property">id</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">network_interface_id</span> <span class="cm-operator">=</span> <span class="cm-variable">aws_network_interface</span><span class="cm-operator">.</span><span class="cm-property">private_eni</span><span class="cm-operator">.</span><span class="cm-property">id</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">device_index</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-operator">=</span> <span class="cm-number">1</span> <span class="cm-comment"># &lt;-- مهم جدًا: 0 هو الكارت الأساسي، يبقى ده رقم 1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 1568px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1568px;"></div></div></div></pre><p>&nbsp;</p><p><span>وحاجة أخيرة، لو أنت جوه السيرفر نفسه وعايز تعرف أي معلومات عنه زي الـ </span><code>IP</code><span> بتاعه أو الـ </span><code>instance ID</code><span>، مش محتاج تفتح الـ Console. أمازون موفرة نظام اسمه </span><code>instance metadata</code><span>، وده عنوان داخلي ثابت (</span><code>http://169.254.169.254</code><span>) تقدر تكلمه من الـ </span><code>command line</code><span> جوه السيرفر عشان تسأله عن أي معلومة تخص السيرفر نفسه وهو هيرد عليك.</span></p><p><span>هنتكلم عن إزاي تدخل على الـ </span><code>instance</code><span> كـ </span><code>administrator</code><span> بعدين في الجزء بتاع الـ </span><code>security</code><span>. بس في حاجات كتير ممكن تعرفها عن أي </span><code>EC2 instance</code><span> شغالة — بما فيهم الـ </span><code>IP addresses</code><span> اللي هتحتاجها عشان تعمل </span><code>connect</code><span> — عن طريق حاجة اسمها </span><strong><span>instance metadata system</span></strong><span>.</span></p><div class="md-alert md-alert-tip tip"><p><span class='md-alert-text md-alert-text-tip'><svg viewBox="0 0 16 16" version="1.1" width="1em" height="1em" aria-hidden="true"><path d="M8 1.5c-2.363 0-4 1.69-4 3.75 0 .984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75 0 0 1-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456 0 0 0-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863 0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751 0 0 1-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304 0-2.06-1.637-3.75-4-3.75ZM5.75 12h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5ZM6 15.25a.75.75 0 0 1 .75-.75h2.5a.75.75 0 0 1 0 1.5h-2.5a.75.75 0 0 1-.75-.75Z"></path></svg>Tip</span><br></p><p><span>هتستخدم الـ IP ده </span><strong><span>169.254.169.254</span></strong><span> عشان تشغل الأمر ده، </span><strong><span>بغض النظر عن الـ Public IP أو الـ Private IP بتوع الـ instance بتاعتك</span></strong><span>.</span></p><p><span>بمعنى تاني، الرقم ده </span><strong><span>ثابت وموحد لكل الـ EC2 instances في العالم</span></strong><span>. هو مش IP عادي على شبكتك، هو مجرد &quot;عنوان سحري&quot; أمازون بتفهمه جوه الـ infrastructure بتاعتها عشان توصلك بخدمة الـ metadata الخاصة بالسيرفر اللي أنت جواه.</span></p><p>&nbsp;</p></div><p><span>لو شغلت أمر </span><code>curl</code><span> ده من الـ </span><code>command line</code><span> وإنت جوه الـ </span><code>instance</code><span>، هيرجعلك لستة بأنواع الداتا اللي ممكن تعرفها:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="bash"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 17.0231px; left: 7.6302px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">$ curl</span> http://169.254.169.254/latest/meta-data/</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 22px;"></div><div class="CodeMirror-gutters" style="display: none; height: 22px;"></div></div></div></pre><p><strong><span>النتيجة هتبقى حاجة زي كده:</span></strong></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 17.0234px; left: 7.6302px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">ami-id</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">ami-launch-index</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">...</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">hostname</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">instance-id</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">instance-type</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">local-ipv4</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">public-ipv4</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">...</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">security-groups</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 224px;"></div><div class="CodeMirror-gutters" style="display: none; height: 224px;"></div></div></div></pre><p><span>أي حاجة آخرها علامة </span><code>/</code><span> بيبقى جواها معلومات تانية ممكن تعرضها. ولو ضفت نوع الداتا اللي عايزه على أمر </span><code>curl</code><span>، هيرجعلك المعلومة اللي أنت بتدور عليها. المثال ده بيعرض اسم الـ </span><code>security groups</code><span> اللي الـ </span><code>instance</code><span> بتستخدمها:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="bash"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 17.0234px; left: 7.6302px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">$ curl</span> http://169.254.169.254/latest/meta-data/security-groups</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 22px;"></div><div class="CodeMirror-gutters" style="display: none; height: 22px;"></div></div></div></pre><h2 id='تأمين-الـ-ec2-instance-بتاعتك'><strong><span>تأمين الـ EC2 Instance بتاعتك</span></strong></h2><p><span>أنت مسؤول عن إنك تظبط وسائل تحكم فعالة ومناسبة عشان تحمي الـ </span><code>EC2 instances</code><span> بتاعتك من أي استخدام مش مصرح بيه. وبشكل عام، AWS بتديلك أربع أدوات عشان تساعدك في المهمة دي: </span><strong><span>Security Groups</span></strong><span>، و </span><strong><span>Identity and Access Management (IAM) roles</span></strong><span>، و </span><strong><span>network address translation (NAT) instances</span></strong><span>، و </span><strong><span>Key Pairs</span></strong><span>.</span></p><h4 id='الـ-security-groups'><strong><span>الـ Security Groups </span></strong></h4><p><span>الـ </span><strong><span>EC2 security group</span></strong><span> بيلعب دور الـ </span><code>firewall</code></p><p><span>في الوضع الافتراضي، الـ </span><code>security group</code><span> </span><strong><span>بيمنع كل الـ </span><code>traffic</code><span> اللي داخل</span></strong><span>، وفي نفس الوقت </span><strong><span>بيسمح لكل الـ </span><code>traffic</code><span> اللي خارج</span></strong><span>. أنت بتحدد سلوك الـ </span><code>group</code><span> ده بإنك تحط قواعد (</span><code>policy rules</code><span>) يا إما تمنع يا إما تسمح بأنواع </span><code>traffic</code><span> معينة. ومن اللحظة دي، أي </span><code>data packet</code><span> (حزمة بيانات) داخلة أو خارجة من حدود السيرفر، هتتقاس على القواعد دي ويتعمل معاها اللازم.</span></p><p><span>الـ </span><code>Traffic</code><span> بيتقيّم عن طريق فحص المصدر بتاعه والوجهة بتاعته، والـ </span><code>network port</code><span> اللي هو رايحله، والبروتوكول اللي هو بيستخدمه.</span></p><p><strong><span>مثال:</span></strong>
<span>ممكن تسمح لـ </span><code>TCP packet</code><span> رايحة لـ </span><code>port 22</code><span> بتاع الـ </span><code>SSH</code><span> إنها توصل لـ </span><code>instance</code><span> معينة، </span><strong><span>بس بشرط</span></strong><span> إن الـ </span><code>IP address</code><span> بتاع المصدر يكون هو نفس الـ </span><code>public IP</code><span> بتاع أجهزة الكمبيوتر اللي في مكتبك. وده بيخليك تفتح الـ </span><code>SSH</code><span> على الـ </span><code>instance</code><span> بتاعتك من غير ما تقلق إن أي حد من بره شركتك يقدر يدخل.</span></p><p><span>باستخدام الـ </span><code>security groups</code><span>، أنت بتقدر بسهولة تعمل مجموعات قواعد معقدة عشان تتحكم بدقة في مين يوصل للخدمات بتاعتك. ممكن مثلاً تفتح ويب سايت للعالم كله، وفي نفس الوقت تمنع الوصول للـ </span><code>backend servers</code><span> بتاعتك عن أي حد ما عدا أعضاء فريقك.</span></p><p><span>ولو احتجت، ممكن تحدث قواعد الـ </span><code>security group</code><span> بتاعتك أو تطبقها على كذا </span><code>instance</code><span> في أي وقت.</span></p><ul><li><p>&nbsp;</p></li></ul><hr /><h3 id='قبل-ما-نبدأ-الكود-الأساسي-اللي-هنغير-فيه'><strong><span>قبل ما نبدأ: الكود الأساسي (اللي هنغير فيه)</span></strong></h3><p><span>كل الأمثلة اللي جاية هتعدل على الجزء بتاع </span><code>ingress</code><span> (اللي داخل) و </span><code>egress</code><span> (اللي طالع) جوه الـ </span><code>resource</code><span> ده.</span></p><ul><li><p><strong><code>protocol</code><span>:</span></strong><span> بتكتب </span><code>tcp</code><span>, </span><code>udp</code><span>, </span><code>icmp</code><span> أو </span><code>-1</code><span> (للـ كل).</span></p></li><li><p><strong><code>from_port</code><span> / </span><code>to_port</code><span>:</span></strong><span> بتحدد البورت أو الرينج. لو عايز كل البورتات، بتكتب </span><code>0</code><span>.</span></p></li><li><p><strong><code>cidr_blocks</code><span>:</span></strong><span> بتحدد الـ IPs المسموح بيها. </span><code>0.0.0.0/0</code><span> يعني أي حد.</span></p></li><li><p><strong><code>security_groups</code><span>:</span></strong><span> بتحدد الـ Security Groups التانية المسموح بيها</span></p></li></ul><hr /><h3 id='مثال-1-السماح-ببروتوكول-واحد-بس-زي-الـ-ssh'><strong><span>مثال 1: السماح ببروتوكول واحد بس (زي الـ SSH)</span></strong></h3><p><span>ده أشهر مثال، بتسمح لجهازك بس إنه يدخل على السيرفر عن طريق SSH.</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="terraform" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="terraform"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 17.0235px; left: 7.6302px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># --- اللي داخل (Ingress) ---</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">ingress</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">description</span> <span class="cm-operator">=</span> <span class="cm-string">"Allow SSH from my IP only"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">from_port</span> &nbsp; <span class="cm-operator">=</span> <span class="cm-number">22</span> &nbsp; &nbsp; &nbsp;<span class="cm-comment"># بورت الـ SSH</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">to_port</span> &nbsp; &nbsp; <span class="cm-operator">=</span> <span class="cm-number">22</span> &nbsp; &nbsp; &nbsp;<span class="cm-comment"># نفس البورت</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">protocol</span> &nbsp; &nbsp;<span class="cm-operator">=</span> <span class="cm-string">"tcp"</span> &nbsp; <span class="cm-comment"># بروتوكول الـ SSH</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">cidr_blocks</span> <span class="cm-operator">=</span> [<span class="cm-string">"YOUR_IP_ADDRESS/32"</span>] <span class="cm-comment"># &lt;-- حط الـ IP بتاعك هنا</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># --- اللي طالع (Egress) ---</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># هنسمح للسيرفر يكلم أي حد بره (ده الوضع الآمن في العادي)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">egress</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">from_port</span> &nbsp; <span class="cm-operator">=</span> <span class="cm-number">0</span> &nbsp; &nbsp; &nbsp; <span class="cm-comment"># من أول بورت</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">to_port</span> &nbsp; &nbsp; <span class="cm-operator">=</span> <span class="cm-number">0</span> &nbsp; &nbsp; &nbsp; <span class="cm-comment"># لآخر بورت</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">protocol</span> &nbsp; &nbsp;<span class="cm-operator">=</span> <span class="cm-string">"-1"</span> &nbsp; &nbsp;<span class="cm-comment"># -1 معناها "كل البروتوكولات"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">cidr_blocks</span> <span class="cm-operator">=</span> [<span class="cm-string">"0.0.0.0/0"</span>] <span class="cm-comment"># لأي مكان في العالم</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 381px;"></div><div class="CodeMirror-gutters" style="display: none; height: 381px;"></div></div></div></pre><ul><li><p><strong><code>ingress</code><span>:</span></strong><span> فتحنا بورت 22 TCP بس، ومن الـ IP بتاعك بس.</span></p></li><li><p><strong><code>egress</code><span>:</span></strong><span> فتحنا كل حاجة طالعة، عشان السيرفر يقدر يعمل </span><code>updates</code><span> أو يكلم أي </span><code>API</code><span>.</span></p></li></ul><hr /><h3 id='مثال-2-فتح-كل-حاجة-داخلة-وكل-حاجة-طالعة-غير-آمن-إطلاقًا'><strong><span>مثال 2: فتح كل حاجة داخلة وكل حاجة طالعة (غير آمن إطلاقًا)</span></strong></h3><p><span>ده بيخلي السيرفر بتاعك مكشوف للعالم كله. </span><strong><span>لا تستخدمه إلا لو بتجرب حاجة بسرعة وهتمسحها.</span></strong></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="terraform" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="terraform"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 17.0235px; left: 7.6302px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># --- اللي داخل (Ingress) ---</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># اسمح لأي حد يكلم أي بورت بأي بروتوكول</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">ingress</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">from_port</span> &nbsp; <span class="cm-operator">=</span> <span class="cm-number">0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">to_port</span> &nbsp; &nbsp; <span class="cm-operator">=</span> <span class="cm-number">0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">protocol</span> &nbsp; &nbsp;<span class="cm-operator">=</span> <span class="cm-string">"-1"</span> <span class="cm-comment"># كل البروتوكولات</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">cidr_blocks</span> <span class="cm-operator">=</span> [<span class="cm-string">"0.0.0.0/0"</span>] <span class="cm-comment"># من أي مكان</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># --- اللي طالع (Egress) ---</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># اسمح للسيرفر يكلم أي حد</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">egress</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">from_port</span> &nbsp; <span class="cm-operator">=</span> <span class="cm-number">0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">to_port</span> &nbsp; &nbsp; <span class="cm-operator">=</span> <span class="cm-number">0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">protocol</span> &nbsp; &nbsp;<span class="cm-operator">=</span> <span class="cm-string">"-1"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">cidr_blocks</span> <span class="cm-operator">=</span> [<span class="cm-string">"0.0.0.0/0"</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 381px;"></div><div class="CodeMirror-gutters" style="display: none; height: 381px;"></div></div></div></pre><h3 id='مثال-3-قفل-كل-حاجة-طالعة-عزل-كامل'><strong><span>مثال 3: قفل كل حاجة طالعة (عزل كامل)</span></strong></h3><p><span>ده بيخلي السيرفر معزول تمامًا. لا حد يعرف يكلمه، ولا هو يعرف يكلم حد. مفيد لو عندك سيرفر بيعمل حسابات داخلية ومش محتاج أي اتصال خارجي.</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="terraform"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="terraform"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 17.0235px; left: 7.6302px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># --- اللي داخل (Ingress) ---</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># مفيش أي قواعد، يعني كله مقفول (ده الوضع الافتراضي)</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># --- اللي طالع (Egress) ---</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># أمازون بتعمل قاعدة بتفتح كل حاجة طالعة افتراضيًا، لازم نمسحها</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># بنحط بلوك egress فاضي عشان نلغي القاعدة الافتراضية دي</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">egress</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment"># مفيش أي قواعد هنا، يعني كله مقفول</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 202px;"></div><div class="CodeMirror-gutters" style="display: none; height: 202px;"></div></div></div></pre><hr /><h3 id='مثال-4-فتح-رينج-range-من-البورتات'><strong><span>مثال 4: فتح رينج (Range) من البورتات</span></strong></h3><p><span>ده مفيد لو عندك </span><code>application</code><span> بيستخدم مجموعة بورتات ورا بعض، زي الـ </span><code>Active FTP</code><span>.</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="terraform"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="terraform"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 17.0236px; left: 7.6302px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">ingress</span> {</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">description</span> <span class="cm-operator">=</span> <span class="cm-string">"Allow Active FTP ports"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">from_port</span> &nbsp; <span class="cm-operator">=</span> <span class="cm-number">20000</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">to_port</span> &nbsp; &nbsp; <span class="cm-operator">=</span> <span class="cm-number">21000</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">protocol</span> &nbsp; &nbsp;<span class="cm-operator">=</span> <span class="cm-string">"tcp"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">cidr_blocks</span> <span class="cm-operator">=</span> [<span class="cm-string">"0.0.0.0/0"</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># ... لازم تكمل باقي القواعد زي egress ...</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 202px;"></div><div class="CodeMirror-gutters" style="display: none; height: 202px;"></div></div></div></pre><p><strong><span>شرح:</span></strong><span> كده أنت فتحت كل البورتات من 20000 لحد 21000.</span></p><hr /><h3 id='مثال-5-السماح-ببروتوكولات-مختلفة-في-نفس-الوقت'><strong><span>مثال 5: السماح ببروتوكولات مختلفة في نفس الوقت</span></strong></h3><p><span>ده مثال واقعي لـ </span><code>Web Server</code><span>. هنفتح بورت 80 (HTTP) وبورت 443 (HTTPS) للعالم كله، وهنفتح بورت 22 (SSH) ليك أنت بس.</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="terraform" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="terraform"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 17.0236px; left: 7.6302px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">ingress</span> {</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">description</span> <span class="cm-operator">=</span> <span class="cm-string">"Allow HTTP traffic"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">from_port</span> &nbsp; <span class="cm-operator">=</span> <span class="cm-number">80</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">to_port</span> &nbsp; &nbsp; <span class="cm-operator">=</span> <span class="cm-number">80</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">protocol</span> &nbsp; &nbsp;<span class="cm-operator">=</span> <span class="cm-string">"tcp"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">cidr_blocks</span> <span class="cm-operator">=</span> [<span class="cm-string">"0.0.0.0/0"</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># القاعدة الثانية: افتح HTTPS للعالم كله</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">ingress</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">description</span> <span class="cm-operator">=</span> <span class="cm-string">"Allow HTTPS traffic"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">from_port</span> &nbsp; <span class="cm-operator">=</span> <span class="cm-number">443</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">to_port</span> &nbsp; &nbsp; <span class="cm-operator">=</span> <span class="cm-number">443</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">protocol</span> &nbsp; &nbsp;<span class="cm-operator">=</span> <span class="cm-string">"tcp"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">cidr_blocks</span> <span class="cm-operator">=</span> [<span class="cm-string">"0.0.0.0/0"</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># القاعدة الثالثة: افتح SSH ليك أنت بس</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">ingress</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">description</span> <span class="cm-operator">=</span> <span class="cm-string">"Allow SSH from my IP"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">from_port</span> &nbsp; <span class="cm-operator">=</span> <span class="cm-number">22</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">to_port</span> &nbsp; &nbsp; <span class="cm-operator">=</span> <span class="cm-number">22</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">protocol</span> &nbsp; &nbsp;<span class="cm-operator">=</span> <span class="cm-string">"tcp"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">cidr_blocks</span> <span class="cm-operator">=</span> [<span class="cm-string">"YOUR_IP_ADDRESS/32"</span>] ]<span class="cm-comment"># &lt;-- حط الـ  الايبي </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># --- اللي طالع (Egress) ---</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># اسمح بكل حاجة طالعة كالعادة</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">egress</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">from_port</span> &nbsp; <span class="cm-operator">=</span> <span class="cm-number">0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">to_port</span> &nbsp; &nbsp; <span class="cm-operator">=</span> <span class="cm-number">0</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">protocol</span> &nbsp; &nbsp;<span class="cm-operator">=</span> <span class="cm-string">"-1"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">cidr_blocks</span> <span class="cm-operator">=</span> [<span class="cm-string">"0.0.0.0/0"</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 761px;"></div><div class="CodeMirror-gutters" style="display: none; height: 761px;"></div></div></div></pre><hr /><h3 id='مثال-6-السماح-لـ-security-group-تاني-إنه-يكلمك'><strong><span>مثال 6: السماح لـ Security Group تاني إنه يكلمك</span></strong></h3><p><span>ده مثال مهم جدًا. عندك سيرفر </span><code>backend</code><span>، وعايز تسمح للـ </span><code>Web Servers</code><span> بس إنها تكلمه، مش أي حد تاني.</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="terraform"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="terraform"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 17.0234px; left: 7.6302px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">resource</span> <span class="cm-string">"aws_security_group"</span> <span class="cm-string">"backend_sg"</span> {</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># ...</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">ingress</span> {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-variable">description</span> <span class="cm-operator">=</span> <span class="cm-string">"Allow traffic from Web Servers SG"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">from_port</span> &nbsp; <span class="cm-operator">=</span> <span class="cm-number">3306</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">to_port</span> &nbsp; &nbsp; <span class="cm-operator">=</span> <span class="cm-number">3306</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">protocol</span> &nbsp; &nbsp;<span class="cm-operator">=</span> <span class="cm-string">"tcp"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-variable">security_groups</span> <span class="cm-operator">=</span> [<span class="cm-variable">aws_security_group</span><span class="cm-operator">.</span><span class="cm-property">web_servers_sg</span><span class="cm-operator">.</span><span class="cm-property">id</span>]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  }</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 246px;"></div><div class="CodeMirror-gutters" style="display: none; height: 246px;"></div></div></div></pre><p><span>.دا معناها اي حد معاها </span><code>aws_security_group.web_servers_sg.id</code><span> دي فهو قادر يبعت على </span><code>port</code><span> اللي </span><code>3306</code><span> و نوعه </span><code>tcp</code><span> </span></p><div class="md-alert md-alert-important important"><p><span class='md-alert-text md-alert-text-important'><svg viewBox="0 0 16 16" version="1.1" width="1em" height="1em" aria-hidden="true"><path d="M0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v9.5A1.75 1.75 0 0 1 14.25 13H8.06l-2.573 2.573A1.458 1.458 0 0 1 3 14.543V13H1.75A1.75 1.75 0 0 1 0 11.25Zm1.75-.25a.25.25 0 0 0-.25.25v9.5c0 .138.112.25.25.25h2a.75.75 0 0 1 .75.75v2.19l2.72-2.72a.749.749 0 0 1 .53-.22h6.5a.25.25 0 0 0 .25-.25v-9.5a.25.25 0 0 0-.25-.25Zm7 2.25v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 9a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path></svg>Important</span><br></p><p>&nbsp;</p><p><span>الـ </span><strong><span>Security groups</span></strong><span> بتتحكم في الـ </span><code>traffic</code><span> على مستوى الـ </span><code>instance</code><span>. بس AWS كمان بتديلك </span><strong><span>network access control lists (NACLs)</span></strong><span> ودي بتتربط بـ </span><code>subnets</code><span> كاملة مش بـ </span><code>instances</code><span> فردية.</span></p><p><span>شابتر 4، &quot;Amazon Virtual Private Cloud&quot;، هيناقش الـ </span><code>security groups</code><span> والـ </span><code>NACLs</code><span> هما الاتنين احنا لسه بنسخن.</span></p></div><p><span>تمام، أهو شرح الحتتين دول بأسلوبنا المصري السهل والمباشر.</span></p><hr /><h2 id='الـ-iam-roles'><strong><span>الـ IAM Roles</span></strong></h2><p><span>أنت ممكن كمان تتحكم في الوصول للـ </span><code>AWS resources</code><span> — بما فيها الـ </span><code>EC2 instances</code><span> — عن طريق استخدام الـ </span><strong><span>IAM roles</span></strong><span>. أنت بتعرّف الـ </span><code>IAM role</code><span> بإنك تديله صلاحيات إنه يعمل </span><code>actions</code><span> معينة على خدمات أو </span><code>resources</code><span> محددة جوه الـ </span><code>AWS account</code><span> بتاعك. ولما الـ </span><code>role</code><span> ده بيتعين لـ </span><code>user</code><span> أو </span><code>resource</code><span> معين، بياخدوا صلاحية الوصول لأي </span><code>resources</code><span> كانت محطوطة في الـ </span><code>policies</code><span> بتاعة الـ </span><code>role</code><span> ده.</span></p><p><span>باستخدام الـ </span><code>roles</code><span>، أنت ممكن تدي عدد محدود من  </span><code>entities</code><span> — زي </span><code>resources</code><span> تانية أو </span><code>users</code><span> — وصول حصري لـ </span><code>resources</code><span> زي الـ </span><code>EC2 instances</code><span> بتاعتك. بس أنت ممكن كمان تعين </span><code>IAM role</code><span> لـ </span><code>EC2 instance</code><span> نفسها، عشان الـ </span><code>processes</code><span> اللي شغالة جواها تقدر توصل للأدوات الخارجية اللي هي محتاجاها عشان تعمل شغلها — زي مثلاً </span><code>RDS database instance</code><span>.</span></p><p><span>(هنتعلم أكتر عن الـ IAM في شابتر 6).</span></p><h2 id='أجهزة-الـ-nat'><strong><span>أجهزة الـ NAT</span></strong></h2><p><span>أحيانًا هتحتاج تعمل </span><code>EC2 instance</code><span> من غير </span><code>public IP address</code><span> عشان تقلل تعرضها للشبكة. وطبعًا، ده معناه إنها مش هيبقى عندها أي اتصال بالإنترنت. بس ده ممكن يعمل مشكلة، لأنك غالبًا هتبقى لسه محتاج تديها وصول للإنترنت عشان تقدر تستقبل تحديثات الأمان (</span><code>security patches</code><span>) وتحديثات البرامج.</span></p><p><span>حل من الحلول هو إنك تستخدم </span><strong><span>network address translation (NAT)</span></strong><span> عشان تدي الـ </span><code>instance</code><span> الـ </span><code>private</code><span> بتاعتك وصول للإنترنت </span><strong><span>من غير ما تسمح</span></strong><span> بوصول ليها </span><strong><span>من</span></strong><span> الإنترنت.</span></p><p><span>AWS بتديلك طريقتين عشان تعمل كده: </span><strong><span>NAT instance</span></strong><span> و </span><strong><span>NAT gateway</span></strong><span> (زي ما باين في شكل 2.2). هما الاتنين بيعملوا نفس الشغلانة، بس بما إن الـ </span><code>NAT gateway</code><span> خدمة </span><code>managed</code><span> (أمازون بتديرها)، هي مش محتاجة إنك تعمل </span><code>launch</code><span> وتصين </span><code>instance</code><span> بنفسك. الطريقتين بيكلفوا مصاريف شهرية.</span></p><p><span>(هنتعلم أكتر عن الـ NAT في شابتر 4).</span></p><p><strong><span>شكل 2.2</span></strong>
<em><code>NAT gateway</code><span> بتدي وصول للشبكة للـ </span><code>resources</code><span> اللي في الـ </span><code>private subnets</code><span> جوه الـ </span><code>VPC</code><span>.</span></em></p><p><img src="/home/Taha/.config/Typora/typora-user-images/image-20250619201130110.png" referrerpolicy="no-referrer" alt="image-20250619201130110"></p><p>&nbsp;</p><h3 id='الـ-key-pairs'><strong><span>الـ Key Pairs </span></strong></h3><p><span>زي ما أي </span><code>administrator</code><span> محترف عارف، sessions الدخول عن بعد (</span><code>remote login</code><span>) على الـ </span><code>instances</code><span> الشغالة بتاعتك مينفعش أبدًا تتعمل عن طريق اتصالات </span><code>plain-text</code><span> مش متشفرة. عشان تضمن إن sessions دي متأمّنة صح، هتحتاج تعمل </span><strong><span>key pair</span></strong><span>، وتحفظ الـ </span><strong><span>public key</span></strong><span>  على سيرفر الـ EC2 بتاعك، وتحفظ نصه التاني الـ </span><strong><span>private</span></strong><span> على جهازك أنت.</span></p><ul><li><p><strong><span>لو شغال على Windows AMI:</span></strong><span> هتستخدم ملف الـ </span><code>private key</code><span> عشان تجيب الباسوورد اللي هتحتاجه عشان تعمل </span><code>authenticate</code><span> وتدخل على الـ </span><code>instance</code><span> بتاعتك.</span></p></li><li><p><strong><span>لو شغال على Linux AMI:</span></strong><span> الـ </span><code>private key</code><span> هيسمحلك تفتح </span><code>SSH session</code><span>.</span></p></li></ul><p><span>كل </span><code>key pair</code><span> أمازون بتعملهولك هيفضل متثبت جوه الـ </span><code>region</code><span> الأصلية بتاعته ومتاح للاستخدام مع أي </span><code>instances</code><span> جديدة بتشغلها، لحد ما أنت تمسحه. المفروض تمسح النسخة اللي على AWS في حالة إن الـ </span><code>private key</code><span> بتاعك ضاع أو اتكشف. بس خد بالك كويس قبل ما تلعب في المفاتيح بتاعتك — وصولك للـ </span><code>instance</code><span> ممكن يكون معتمد عليه.</span></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><h2 id='الـ-ec2-auto-scaling'><strong><span>الـ EC2 Auto Scaling</span></strong></h2><p><span>خدمة الـ </span><strong><span>EC2 Auto Scaling</span></strong><span> بتديلك طريقة عشان تتجنب فشل الـ </span><code>application</code><span> بتاعك، وكمان عشان تتعافى منه لما يحصل. الـ </span><code>Auto Scaling</code><span> بيشتغل عن طريق إنه بيجهز ويشغل بالنيابة عنك عدد معين من الـ </span><code>EC2 instances</code><span>. وبيقدر يزود </span><code>instances</code><span> أكتر بشكل ديناميكي عشان يواكب الزيادة في الطلب. ولما </span><code>instance</code><span> بتقع أو بتتمسح، الـ </span><code>Auto Scaling</code><span> بيستبدلها بواحدة جديدة أوتوماتيك.</span></p><p><span>الـ </span><code>EC2 Auto Scaling</code><span> بيستخدم يا إما </span><strong><span>launch configuration</span></strong><span> أو </span><strong><span>launch template</span></strong><span> عشان يظبط إعدادات الـ </span><code>instances</code><span> اللي بيشغلها. هما الاتنين بيعملوا نفس الوظيفة الأساسية وهي إنهم بيحددوا إعدادات الـ </span><code>instance</code><span> الأساسية، وكمان إيه الـ </span><code>scripts</code><span> (لو فيه) اللي هتشتغل عليها أول ما تقوم.</span></p><ul><li><p><strong><span>Launch Configurations:</span></strong><span> دي موجودة من زمان، وهتبقى مألوفة ليك لو بتستخدم AWS من فترة. وغالبًا هتقابلها لو داخل على بيئة AWS موجودة بالفعل (اتشال عنه الدعم اخر مرة جربته طلع مات )</span></p></li><li><p><strong><span>Launch Templates:</span></strong><span> دي الأحدث، وهي اللي AWS بتنصح بيها حاليًا.</span></p></li></ul><p><span>هنتعلم عن الاتنين، بس أنهي واحدة تستخدمها ده قرارك أنت.</span></p><h3 id='الـ-launch-configurations-والـ-launch-templates'><strong><span>الـ Launch Configurations والـ Launch Templates</span></strong></h3><p><span>عشان الـ </span><code>Auto Scaling</code><span> يعرف إزاي يبني السيرفرات الجديدة بتاعتك، لازم تديله &quot;كتالوج&quot; أو &quot;وصفة&quot; فيها كل مواصفات السيرفر اللي أنت عايزه. الوصفة دي ممكن تكون واحدة من اتنين: </span><code>Launch Configuration</code><span> أو </span><code>Launch Template</code><span>.</span></p><h4 id='الـ-launch-configurations'><strong><span>الـ Launch Configurations </span></strong></h4><ul><li><p><strong><span>إيه هي؟</span></strong><span> دي كانت الطريقة الأصلية والقديمة. هي عبارة عن ملف إعدادات ثابت بتسجل فيه كل حاجة عن السيرفر اللي عايزه: نوعه إيه، الـ </span><code>AMI</code><span> بتاعته، الـ </span><code>Security Group</code><span>، وهكذا.</span></p></li><li><p><strong><span>مميزاتها وعيوبها:</span></strong></p><ul><li><p><strong><span>عيبها الأكبر (عدم المرونة):</span></strong><span> أول ما بتعمل </span><code>Launch Configuration</code><span> وتدوس </span><code>save</code><span>، </span><strong><span>مبتقدرش تعدل فيه تاني أبدًا</span></strong><span>. لو حبيت تغير أي حاجة، حتى لو حاجة بسيطة زي حجم السيرفر، لازم تمسحه وتعمل واحد جديد خالص من الصفر. ده بيخلي التغيير والتطوير صعب وممل.</span></p></li><li><p><strong><span>عيب تاني (الاستخدام المحدود):</span></strong><span> الـ </span><code>Launch Configurations</code><span> معمولة عشان تشتغل مع الـ </span><code>Auto Scaling</code><span> </span><strong><span>وبس</span></strong><span>. متقدرش تستخدمها عشان تشغل سيرفر واحد بنفسك لو حبيت.</span></p></li></ul></li></ul><h4 id='الـ-launch-templates'><strong><span>الـ Launch Templates</span></strong></h4><ul><li><p><strong><span>إيه هي؟</span></strong><span> دي الطريقة الأحدث واللي أمازون بتنصح بيها حاليًا. هي برضه ملف إعدادات بتحط فيه مواصفات السيرفر، لكن معمولة عشان تكون مرنة وقوية أكتر بكتير.</span></p></li><li><p><strong><span>مميزاتها وعيوبها:</span></strong></p><ul><li><p><strong><span>ميزتها الكبيرة (المرونة والتعديل):</span></strong><span> الـ </span><code>Launch Template</code><span> بيشتغل بنظام </span><strong><span>الإصدارات (Versions)</span></strong><span>. لو عملت </span><code>template</code><span> وحبيت تغير حاجة فيه، مش بتمسحه. أنت بتعمل </span><strong><code>version</code><span> جديد</span></strong><span> منه بالتعديلات الجديدة. أمازون بتحتفظ بكل الإصدارات القديمة والجديدة، وتقدر تبدل بينهم بسهولة. ده بيخليك تتابع التغييرات وتجرب حاجات جديدة وترجع للإصدار القديم لو حبيت.</span></p></li><li><p><strong><span>ميزة تانية (استخدامات متعددة):</span></strong><span> الـ </span><code>Launch Template</code><span> مش محصور على الـ </span><code>Auto Scaling</code><span> بس. تقدر تستخدم نفس الـ </span><code>template</code><span> عشان تشغل سيرفر واحد بنفسك، أو تشغل</span>
<span> </span><code>Spot Instances</code><span>، أو </span><code>Spot Fleets</code><span>، أو تستخدمه مع الـ </span><code>Auto Scaling</code><span>. </span></p></li></ul></li></ul><p><span>لو عندك شغل قديم، ممكن تلاقي فيه </span><code>Launch Configurations</code><span>. لو بتبدأ حاجة جديدة، </span><strong><span>دايمًا استخدم الـ Launch Templates</span></strong><span>.</span></p><div class="md-alert md-alert-caution caution"><p><span class='md-alert-text md-alert-text-caution'><svg viewBox="0 0 16 16" version="1.1" width="1em" height="1em" aria-hidden="true"><path d="M4.47.22A.749.749 0 0 1 5 0h6c.199 0 .389.079.53.22l4.25 4.25c.141.14.22.331.22.53v6a.749.749 0 0 1-.22.53l-4.25 4.25A.749.749 0 0 1 11 16H5a.749.749 0 0 1-.53-.22L.22 11.53A.749.749 0 0 1 0 11V5c0-.199.079-.389.22-.53Zm.84 1.28L1.5 5.31v5.38l3.81 3.81h5.38l3.81-3.81V5.31L10.69 1.5ZM8 4a.75.75 0 0 1 .75.75v3.5a.75.75 0 0 1-1.5 0v-3.5A.75.75 0 0 1 8 4Zm0 8a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path></svg>Caution</span><br></p><p><span>مخي هيفرقع انا المفروض اعمل امثلة بterraform والمفروض اشرحلك يعني ايه Spot Fleets وازاي تستخدمها و Spot Instances فأنا لسالي شوية و أعيط فنكتفى بهذا القدر 50 صفحة في يوم كفاية </span></p></div><p>&nbsp;</p></div></div>
</body>
</html>